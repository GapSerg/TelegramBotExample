2022-10-11 10:43:55,974 INFO org.springframework.boot.StartupInfoLogger [main] Starting SpringGodelBotApplication using Java 11.0.12 on INV-2021-L with PID 3444 (C:\Users\a.miachyn\IdeaProjects\SpringGodelBot\target\classes started by a.miachyn in C:\Users\a.miachyn\IdeaProjects\SpringGodelBot)
2022-10-11 10:43:55,990 INFO org.springframework.boot.SpringApplication [main] No active profile set, falling back to 1 default profile: "default"
2022-10-11 10:43:56,685 INFO org.springframework.data.repository.config.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2022-10-11 10:43:56,774 INFO org.springframework.data.repository.config.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 73 ms. Found 4 JPA repository interfaces.
2022-10-11 10:43:57,223 INFO org.springframework.boot.web.embedded.tomcat.TomcatWebServer [main] Tomcat initialized with port(s): 5000 (http)
2022-10-11 10:43:57,239 INFO org.apache.juli.logging.DirectJDKLog [main] Initializing ProtocolHandler ["http-nio-5000"]
2022-10-11 10:43:57,239 INFO org.apache.juli.logging.DirectJDKLog [main] Starting service [Tomcat]
2022-10-11 10:43:57,239 INFO org.apache.juli.logging.DirectJDKLog [main] Starting Servlet engine: [Apache Tomcat/9.0.65]
2022-10-11 10:43:57,344 INFO org.apache.juli.logging.DirectJDKLog [main] Initializing Spring embedded WebApplicationContext
2022-10-11 10:43:57,344 INFO org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext [main] Root WebApplicationContext: initialization completed in 1307 ms
2022-10-11 10:43:57,560 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Starting...
2022-10-11 10:43:57,648 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Start completed.
2022-10-11 10:43:57,757 INFO liquibase.logging.core.JavaLogger [main] Set default schema name to public
2022-10-11 10:43:57,873 INFO liquibase.logging.core.JavaLogger [main] Successfully acquired change log lock
2022-10-11 10:43:58,200 INFO liquibase.logging.core.JavaLogger [main] Creating database history table with name: public.databasechangelog
2022-10-11 10:43:58,209 INFO liquibase.logging.core.JavaLogger [main] Reading from public.databasechangelog
2022-10-11 10:43:58,344 INFO liquibase.logging.core.JavaLogger [main] Table telegram_user created
2022-10-11 10:43:58,348 INFO liquibase.logging.core.JavaLogger [main] ChangeSet db/changelog/v.0.1/2022-09-06-changes-create-table-user.xml::2022-09-06-changes-create-table-userEntity::a.miachyn ran successfully in 33ms
2022-10-11 10:43:58,375 INFO liquibase.logging.core.JavaLogger [main] Table city created
2022-10-11 10:43:58,378 INFO liquibase.logging.core.JavaLogger [main] ChangeSet db/changelog/v.0.2/2022-09-08-changes-create-table-city.xml::2022-09-08-changes-create-table-city::a.miachyn ran successfully in 23ms
2022-10-11 10:43:58,386 INFO liquibase.logging.core.JavaLogger [main] New row inserted into city
2022-10-11 10:43:58,389 INFO liquibase.logging.core.JavaLogger [main] New row inserted into city
2022-10-11 10:43:58,392 INFO liquibase.logging.core.JavaLogger [main] New row inserted into city
2022-10-11 10:43:58,394 INFO liquibase.logging.core.JavaLogger [main] New row inserted into city
2022-10-11 10:43:58,397 INFO liquibase.logging.core.JavaLogger [main] New row inserted into city
2022-10-11 10:43:58,399 INFO liquibase.logging.core.JavaLogger [main] New row inserted into city
2022-10-11 10:43:58,402 INFO liquibase.logging.core.JavaLogger [main] ChangeSet db/changelog/v.0.2/2022-09-08-changes-filling-table-city.xml::2022-09-08-changes-filling-table-city::a.miachyn ran successfully in 19ms
2022-10-11 10:43:58,416 INFO liquibase.logging.core.JavaLogger [main] Custom SQL executed
2022-10-11 10:43:58,418 INFO liquibase.logging.core.JavaLogger [main] ChangeSet db/changelog/v.0.3/2022-09-11-changes-create-type-activity_type.xml::2022-09-11--create-type-activity_type::a.miachyn ran successfully in 10ms
2022-10-11 10:43:58,441 INFO liquibase.logging.core.JavaLogger [main] Table offer created
2022-10-11 10:43:58,444 INFO liquibase.logging.core.JavaLogger [main] ChangeSet db/changelog/v.0.3/2022-09-11-changes-create-table-offer.xml::2022-09-11-changes-create-table-offer::a.miachyn ran successfully in 20ms
2022-10-11 10:43:58,469 INFO liquibase.logging.core.JavaLogger [main] Table offer_city created
2022-10-11 10:43:58,472 INFO liquibase.logging.core.JavaLogger [main] ChangeSet db/changelog/v.0.3/2022-09-11-changes-create-table-offer-city.xml::2022-09-11-changes-create-table-offer_city::a.miachyn ran successfully in 21ms
2022-10-11 10:43:58,480 INFO liquibase.logging.core.JavaLogger [main] Null constraint dropped from telegram_user.first_name
2022-10-11 10:43:58,482 INFO liquibase.logging.core.JavaLogger [main] Null constraint dropped from telegram_user.last_name
2022-10-11 10:43:58,485 INFO liquibase.logging.core.JavaLogger [main] ChangeSet db/changelog/v.0.4/2022-10-03-changes-alter-table-telegram_user.xml::2022-10-03-changes-alter-table-telegram_user::a.miachyn ran successfully in 8ms
2022-10-11 10:43:58,500 INFO liquibase.logging.core.JavaLogger [main] Null constraint dropped from offer.second_date
2022-10-11 10:43:58,503 INFO liquibase.logging.core.JavaLogger [main] ChangeSet db/changelog/v.0.5/2022-10-07-changes-alter-table-offer-second-date.xml::2022-10-07-changes-alter-table-offer-second-date::a.miachyn ran successfully in 6ms
2022-10-11 10:43:58,526 INFO liquibase.logging.core.JavaLogger [main] Table token created
2022-10-11 10:43:58,529 INFO liquibase.logging.core.JavaLogger [main] ChangeSet db/changelog/v.0.6/2022-10-10-changes-create-table-token.xml::2022-10-10-changes-create-table-token::a.miachyn ran successfully in 22ms
2022-10-11 10:43:58,537 INFO liquibase.logging.core.JavaLogger [main] Successfully released change log lock
2022-10-11 10:43:58,658 INFO org.hibernate.jpa.internal.util.LogHelper [main] HHH000204: Processing PersistenceUnitInfo [name: default]
2022-10-11 10:43:58,715 INFO org.hibernate.Version [main] HHH000412: Hibernate ORM core version 5.6.10.Final
2022-10-11 10:43:58,853 INFO org.hibernate.annotations.common.reflection.java.JavaReflectionManager [main] HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2022-10-11 10:43:58,950 INFO org.hibernate.dialect.Dialect [main] HHH000400: Using dialect: org.hibernate.dialect.PostgreSQL10Dialect
2022-10-11 10:43:59,386 INFO org.hibernate.engine.transaction.jta.platform.internal.JtaPlatformInitiator [main] HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2022-10-11 10:43:59,386 INFO org.springframework.orm.jpa.AbstractEntityManagerFactoryBean [main] Initialized JPA EntityManagerFactory for persistence unit 'default'
2022-10-11 10:44:00,136 WARN org.springframework.boot.autoconfigure.orm.jpa.JpaBaseConfiguration$JpaWebConfiguration [main] spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2022-10-11 10:44:00,393 INFO org.apache.juli.logging.DirectJDKLog [main] Starting ProtocolHandler ["http-nio-5000"]
2022-10-11 10:44:00,426 INFO org.springframework.boot.web.embedded.tomcat.TomcatWebServer [main] Tomcat started on port(s): 5000 (http) with context path ''
2022-10-11 10:44:00,426 INFO com.godeltech.springgodelbot.scheduler.impl.ScheduleServiceImpl [scheduling-1] Deleting expired offers
2022-10-11 10:44:00,426 INFO com.godeltech.springgodelbot.config.BotInitializer [main] Set web hook with path :https://1561-82-209-241-194.eu.ngrok.io
2022-10-11 10:44:00,436 INFO com.godeltech.springgodelbot.service.impl.RestServiceImpl [main] Set webhook with path :https://1561-82-209-241-194.eu.ngrok.io
2022-10-11 10:44:00,451 INFO com.godeltech.springgodelbot.service.impl.TokenServiceImpl [scheduling-1] Remove expired token
2022-10-11 10:44:00,455 INFO com.godeltech.springgodelbot.scheduler.impl.ScheduleServiceImpl [scheduling-1] Deleting expired offers
2022-10-11 10:44:00,455 INFO com.godeltech.springgodelbot.service.impl.OfferServiceImpl [scheduling-1] Delete offers whose second date is earlier than : 2022-10-11
2022-10-11 10:44:00,569 INFO com.godeltech.springgodelbot.service.impl.OfferServiceImpl [scheduling-1] Delete offers whose first date is earlier than :2022-10-11 and second date is null
2022-10-11 10:44:00,954 INFO org.apache.juli.logging.DirectJDKLog [http-nio-5000-exec-1] Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-10-11 10:44:00,954 INFO org.springframework.web.servlet.FrameworkServlet [http-nio-5000-exec-1] Initializing Servlet 'dispatcherServlet'
2022-10-11 10:44:00,954 INFO org.springframework.web.servlet.FrameworkServlet [http-nio-5000-exec-1] Completed initialization in 0 ms
2022-10-11 10:44:01,079 ERROR com.godeltech.springgodelbot.resolver.message.type.impl.TextAndEntityMessageType [http-nio-5000-exec-1] Got /help unknown entity
2022-10-11 10:44:01,079 ERROR com.godeltech.springgodelbot.handler.BotHandler [http-nio-5000-exec-1] Sorry but the command is incorrect
2022-10-11 10:44:01,134 ERROR com.godeltech.springgodelbot.resolver.message.type.impl.TextAndEntityMessageType [http-nio-5000-exec-2] Got /help unknown entity
2022-10-11 10:44:01,134 ERROR com.godeltech.springgodelbot.handler.BotHandler [http-nio-5000-exec-2] Sorry but the command is incorrect
2022-10-11 10:44:01,277 INFO org.springframework.boot.StartupInfoLogger [main] Started SpringGodelBotApplication in 5.75 seconds (JVM running for 6.656)
2022-10-11 10:44:06,260 INFO com.godeltech.springgodelbot.resolver.message.type.impl.TextAndEntityMessageType [http-nio-5000-exec-3] Got /start message
2022-10-11 10:44:06,277 INFO com.godeltech.springgodelbot.service.impl.TudaSudaTelegramBot [http-nio-5000-exec-3] Is he member of group?
2022-10-11 10:44:06,413 INFO com.godeltech.springgodelbot.service.impl.UserServiceImpl [http-nio-5000-exec-3] Check existing of user by id: 834450967
2022-10-11 10:44:06,467 INFO com.godeltech.springgodelbot.service.impl.UserServiceImpl [http-nio-5000-exec-3] Save a new user: UserEntity(id=834450967, firstName=Артем, lastName=Мячин, userName=Myachin97)
2022-10-11 10:44:06,583 INFO com.godeltech.springgodelbot.service.impl.TokenServiceImpl [http-nio-5000-exec-3] Create new token with userId :834450967, messageId: 700 and chatId :834450967
2022-10-11 10:44:08,871 INFO com.godeltech.springgodelbot.service.impl.TokenServiceImpl [http-nio-5000-exec-4] Income message with token :4e4bdfb0893aad384da287
2022-10-11 10:44:08,907 INFO com.godeltech.springgodelbot.resolver.callback.type.impl.ActivityCallbackType [http-nio-5000-exec-4] Got ACTIVITY callback type with activity :PASSENGER and token : 4e4bdfb0893aad384da287
2022-10-11 10:44:08,949 INFO com.godeltech.springgodelbot.service.impl.CityServiceImpl [http-nio-5000-exec-4] Find all routes
2022-10-11 10:44:10,426 INFO com.godeltech.springgodelbot.resolver.callback.type.impl.passenger.PassengerRouteCallbackType [http-nio-5000-exec-5] Callback data with type: PASSENGER_ROUTE and routeId: 2 and with token: 4e4bdfb0893aad384da287
2022-10-11 10:44:11,137 INFO com.godeltech.springgodelbot.resolver.callback.type.impl.passenger.PassengerRouteCallbackType [http-nio-5000-exec-6] Callback data with type: PASSENGER_ROUTE and routeId: 4 and with token: 4e4bdfb0893aad384da287
2022-10-11 10:44:11,911 INFO com.godeltech.springgodelbot.resolver.callback.type.impl.passenger.ChoseDatePassengerCallbackType [http-nio-5000-exec-7] Callback data with type: CHOSE_DATE_PASSENGER with token : 4e4bdfb0893aad384da287
2022-10-11 10:44:14,128 INFO com.godeltech.springgodelbot.resolver.callback.type.impl.passenger.FirstDatePassengerCallbackType [http-nio-5000-exec-8] Got FIRST_DATE_PASSENGER type with first date :2022-11-01 with token: 4e4bdfb0893aad384da287
2022-10-11 10:44:16,762 INFO com.godeltech.springgodelbot.service.impl.OfferServiceImpl [http-nio-5000-exec-9] Find drivers by first date :2022-11-01 and second date:null with cities:[City(id=2, name=BELASTOK), City(id=4, name=GDANSK)]
2022-10-11 10:44:18,834 INFO com.godeltech.springgodelbot.resolver.callback.type.impl.passenger.CheckPassengerCallbackType [http-nio-5000-exec-10] Got callback with type : CHECK_PASSENGER_REQUEST with token : 4e4bdfb0893aad384da287
2022-10-11 10:44:22,677 INFO com.godeltech.springgodelbot.service.impl.TokenServiceImpl [http-nio-5000-exec-1] Find tokens by userId :834450967
2022-10-11 10:44:22,694 INFO com.godeltech.springgodelbot.resolver.message.type.impl.OnlyTextMessageType [http-nio-5000-exec-1] Got message for saving description of passenger with token :4e4bdfb0893aad384da287 
2022-10-11 10:44:22,696 INFO com.godeltech.springgodelbot.service.impl.OfferServiceImpl [http-nio-5000-exec-1] Save passenger request : Request(chatId=834450967, userDto=UserDto(id=834450967, firstName=Артем, lastName=Мячин, userName=Myachin97), cities=[City(id=2, name=BELASTOK), City(id=4, name=GDANSK)], firstDate=2022-11-01, secondDate=null, description=Yap yap, needForDescription=true, messages=[701], activity=PASSENGER)
2022-10-11 10:44:22,791 INFO com.godeltech.springgodelbot.service.impl.TudaSudaTelegramBot [http-nio-5000-exec-1] Delete messages with chat id : 834450967 and messages : [701]
2022-10-11 10:44:22,882 INFO com.godeltech.springgodelbot.service.impl.TokenServiceImpl [http-nio-5000-exec-1] Delete token from messages : 4e4bdfb0893aad384da287
2022-10-11 10:44:22,914 INFO com.godeltech.springgodelbot.service.impl.TokenServiceImpl [http-nio-5000-exec-1] Create new token with userId :834450967 and chatId :834450967
2022-10-11 10:44:22,928 WARN org.hibernate.engine.jdbc.spi.SqlExceptionHelper [http-nio-5000-exec-1] SQL Error: 0, SQLState: 23502
2022-10-11 10:44:22,929 ERROR org.hibernate.engine.jdbc.spi.SqlExceptionHelper [http-nio-5000-exec-1] ERROR: null value in column "message_id" violates not-null constraint
  Detail: Failing row contains (584041b696c811acc0d1ff, 834450967, null, 834450967, 2022-10-11 10:44:22.918974, f).
2022-10-11 10:44:22,932 INFO org.hibernate.engine.jdbc.batch.internal.AbstractBatchImpl [http-nio-5000-exec-1] HHH000010: On release of batch it still contained JDBC statements
2022-10-11 10:44:22,948 ERROR com.godeltech.springgodelbot.handler.BotHandler [http-nio-5000-exec-1] could not execute statement; SQL [n/a]; constraint [message_id]; nested exception is org.hibernate.exception.ConstraintViolationException: could not execute statement
2022-10-11 10:45:27,954 INFO org.springframework.orm.jpa.AbstractEntityManagerFactoryBean [SpringApplicationShutdownHook] Closing JPA EntityManagerFactory for persistence unit 'default'
2022-10-11 10:45:27,975 INFO com.zaxxer.hikari.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown initiated...
2022-10-11 10:45:27,995 INFO com.zaxxer.hikari.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown completed.
2022-10-11 10:46:01,802 INFO org.springframework.boot.StartupInfoLogger [main] Starting SpringGodelBotApplication using Java 11.0.12 on INV-2021-L with PID 11648 (C:\Users\a.miachyn\IdeaProjects\SpringGodelBot\target\classes started by a.miachyn in C:\Users\a.miachyn\IdeaProjects\SpringGodelBot)
2022-10-11 10:46:01,819 INFO org.springframework.boot.SpringApplication [main] No active profile set, falling back to 1 default profile: "default"
2022-10-11 10:46:02,456 INFO org.springframework.data.repository.config.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2022-10-11 10:46:02,543 INFO org.springframework.data.repository.config.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 85 ms. Found 4 JPA repository interfaces.
2022-10-11 10:46:02,940 INFO org.springframework.boot.web.embedded.tomcat.TomcatWebServer [main] Tomcat initialized with port(s): 5000 (http)
2022-10-11 10:46:02,960 INFO org.apache.juli.logging.DirectJDKLog [main] Initializing ProtocolHandler ["http-nio-5000"]
2022-10-11 10:46:02,960 INFO org.apache.juli.logging.DirectJDKLog [main] Starting service [Tomcat]
2022-10-11 10:46:02,960 INFO org.apache.juli.logging.DirectJDKLog [main] Starting Servlet engine: [Apache Tomcat/9.0.65]
2022-10-11 10:46:03,055 INFO org.apache.juli.logging.DirectJDKLog [main] Initializing Spring embedded WebApplicationContext
2022-10-11 10:46:03,063 INFO org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext [main] Root WebApplicationContext: initialization completed in 1218 ms
2022-10-11 10:46:03,174 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Starting...
2022-10-11 10:46:03,263 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Start completed.
2022-10-11 10:46:03,361 INFO liquibase.logging.core.JavaLogger [main] Set default schema name to public
2022-10-11 10:46:03,488 INFO liquibase.logging.core.JavaLogger [main] Successfully acquired change log lock
2022-10-11 10:46:04,101 INFO liquibase.logging.core.JavaLogger [main] Creating database history table with name: public.databasechangelog
2022-10-11 10:46:04,142 INFO liquibase.logging.core.JavaLogger [main] Reading from public.databasechangelog
2022-10-11 10:46:04,461 INFO liquibase.logging.core.JavaLogger [main] Table telegram_user created
2022-10-11 10:46:04,466 INFO liquibase.logging.core.JavaLogger [main] ChangeSet db/changelog/v.0.1/2022-09-06-changes-create-table-user.xml::2022-09-06-changes-create-table-userEntity::a.miachyn ran successfully in 72ms
2022-10-11 10:46:04,510 INFO liquibase.logging.core.JavaLogger [main] Table city created
2022-10-11 10:46:04,512 INFO liquibase.logging.core.JavaLogger [main] ChangeSet db/changelog/v.0.2/2022-09-08-changes-create-table-city.xml::2022-09-08-changes-create-table-city::a.miachyn ran successfully in 35ms
2022-10-11 10:46:04,526 INFO liquibase.logging.core.JavaLogger [main] New row inserted into city
2022-10-11 10:46:04,530 INFO liquibase.logging.core.JavaLogger [main] New row inserted into city
2022-10-11 10:46:04,534 INFO liquibase.logging.core.JavaLogger [main] New row inserted into city
2022-10-11 10:46:04,537 INFO liquibase.logging.core.JavaLogger [main] New row inserted into city
2022-10-11 10:46:04,540 INFO liquibase.logging.core.JavaLogger [main] New row inserted into city
2022-10-11 10:46:04,544 INFO liquibase.logging.core.JavaLogger [main] New row inserted into city
2022-10-11 10:46:04,548 INFO liquibase.logging.core.JavaLogger [main] ChangeSet db/changelog/v.0.2/2022-09-08-changes-filling-table-city.xml::2022-09-08-changes-filling-table-city::a.miachyn ran successfully in 28ms
2022-10-11 10:46:04,570 INFO liquibase.logging.core.JavaLogger [main] Custom SQL executed
2022-10-11 10:46:04,574 INFO liquibase.logging.core.JavaLogger [main] ChangeSet db/changelog/v.0.3/2022-09-11-changes-create-type-activity_type.xml::2022-09-11--create-type-activity_type::a.miachyn ran successfully in 18ms
2022-10-11 10:46:04,613 INFO liquibase.logging.core.JavaLogger [main] Table offer created
2022-10-11 10:46:04,618 INFO liquibase.logging.core.JavaLogger [main] ChangeSet db/changelog/v.0.3/2022-09-11-changes-create-table-offer.xml::2022-09-11-changes-create-table-offer::a.miachyn ran successfully in 34ms
2022-10-11 10:46:04,655 INFO liquibase.logging.core.JavaLogger [main] Table offer_city created
2022-10-11 10:46:04,660 INFO liquibase.logging.core.JavaLogger [main] ChangeSet db/changelog/v.0.3/2022-09-11-changes-create-table-offer-city.xml::2022-09-11-changes-create-table-offer_city::a.miachyn ran successfully in 32ms
2022-10-11 10:46:04,677 INFO liquibase.logging.core.JavaLogger [main] Null constraint dropped from telegram_user.first_name
2022-10-11 10:46:04,682 INFO liquibase.logging.core.JavaLogger [main] Null constraint dropped from telegram_user.last_name
2022-10-11 10:46:04,686 INFO liquibase.logging.core.JavaLogger [main] ChangeSet db/changelog/v.0.4/2022-10-03-changes-alter-table-telegram_user.xml::2022-10-03-changes-alter-table-telegram_user::a.miachyn ran successfully in 16ms
2022-10-11 10:46:04,699 INFO liquibase.logging.core.JavaLogger [main] Null constraint dropped from offer.second_date
2022-10-11 10:46:04,707 INFO liquibase.logging.core.JavaLogger [main] ChangeSet db/changelog/v.0.5/2022-10-07-changes-alter-table-offer-second-date.xml::2022-10-07-changes-alter-table-offer-second-date::a.miachyn ran successfully in 12ms
2022-10-11 10:46:04,753 INFO liquibase.logging.core.JavaLogger [main] Table token created
2022-10-11 10:46:04,757 INFO liquibase.logging.core.JavaLogger [main] ChangeSet db/changelog/v.0.6/2022-10-10-changes-create-table-token.xml::2022-10-10-changes-create-table-token::a.miachyn ran successfully in 37ms
2022-10-11 10:46:04,777 INFO liquibase.logging.core.JavaLogger [main] Successfully released change log lock
2022-10-11 10:46:05,008 INFO org.hibernate.jpa.internal.util.LogHelper [main] HHH000204: Processing PersistenceUnitInfo [name: default]
2022-10-11 10:46:05,072 INFO org.hibernate.Version [main] HHH000412: Hibernate ORM core version 5.6.10.Final
2022-10-11 10:46:05,275 INFO org.hibernate.annotations.common.reflection.java.JavaReflectionManager [main] HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2022-10-11 10:46:05,444 INFO org.hibernate.dialect.Dialect [main] HHH000400: Using dialect: org.hibernate.dialect.PostgreSQL10Dialect
2022-10-11 10:46:06,362 INFO org.hibernate.engine.transaction.jta.platform.internal.JtaPlatformInitiator [main] HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2022-10-11 10:46:06,374 INFO org.springframework.orm.jpa.AbstractEntityManagerFactoryBean [main] Initialized JPA EntityManagerFactory for persistence unit 'default'
2022-10-11 10:46:07,888 WARN org.springframework.boot.autoconfigure.orm.jpa.JpaBaseConfiguration$JpaWebConfiguration [main] spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2022-10-11 10:46:08,489 INFO org.apache.juli.logging.DirectJDKLog [main] Starting ProtocolHandler ["http-nio-5000"]
2022-10-11 10:46:08,531 INFO org.springframework.boot.web.embedded.tomcat.TomcatWebServer [main] Tomcat started on port(s): 5000 (http) with context path ''
2022-10-11 10:46:08,548 INFO com.godeltech.springgodelbot.config.BotInitializer [main] Set web hook with path :https://1561-82-209-241-194.eu.ngrok.io
2022-10-11 10:46:08,548 INFO com.godeltech.springgodelbot.scheduler.impl.ScheduleServiceImpl [scheduling-1] Deleting expired offers
2022-10-11 10:46:08,548 INFO com.godeltech.springgodelbot.service.impl.RestServiceImpl [main] Set webhook with path :https://1561-82-209-241-194.eu.ngrok.io
2022-10-11 10:46:08,590 INFO com.godeltech.springgodelbot.service.impl.OfferServiceImpl [scheduling-1] Delete offers whose second date is earlier than : 2022-10-11
2022-10-11 10:46:08,782 INFO com.godeltech.springgodelbot.service.impl.OfferServiceImpl [scheduling-1] Delete offers whose first date is earlier than :2022-10-11 and second date is null
2022-10-11 10:46:08,793 INFO com.godeltech.springgodelbot.scheduler.impl.ScheduleServiceImpl [scheduling-1] Deleting expired offers
2022-10-11 10:46:08,801 INFO com.godeltech.springgodelbot.service.impl.TokenServiceImpl [scheduling-1] Remove expired token
2022-10-11 10:46:09,609 INFO org.springframework.boot.StartupInfoLogger [main] Started SpringGodelBotApplication in 8.143 seconds (JVM running for 9.072)
2022-10-11 10:46:16,465 INFO org.apache.juli.logging.DirectJDKLog [http-nio-5000-exec-1] Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-10-11 10:46:16,466 INFO org.springframework.web.servlet.FrameworkServlet [http-nio-5000-exec-1] Initializing Servlet 'dispatcherServlet'
2022-10-11 10:46:16,468 INFO org.springframework.web.servlet.FrameworkServlet [http-nio-5000-exec-1] Completed initialization in 2 ms
2022-10-11 10:46:16,789 INFO com.godeltech.springgodelbot.resolver.message.type.impl.TextAndEntityMessageType [http-nio-5000-exec-1] Got /start message
2022-10-11 10:46:16,804 INFO com.godeltech.springgodelbot.service.impl.TudaSudaTelegramBot [http-nio-5000-exec-1] Is he member of group?
2022-10-11 10:46:16,947 INFO com.godeltech.springgodelbot.service.impl.UserServiceImpl [http-nio-5000-exec-1] Check existing of user by id: 834450967
2022-10-11 10:46:17,002 INFO com.godeltech.springgodelbot.service.impl.UserServiceImpl [http-nio-5000-exec-1] Save a new user: UserEntity(id=834450967, firstName=Артем, lastName=Мячин, userName=Myachin97)
2022-10-11 10:46:17,124 INFO com.godeltech.springgodelbot.service.impl.TokenServiceImpl [http-nio-5000-exec-1] Create new token with userId :834450967, messageId: 703 and chatId :834450967
2022-10-11 10:46:21,698 INFO com.godeltech.springgodelbot.service.impl.TokenServiceImpl [http-nio-5000-exec-2] Income message with token :9a4ca19d9ffaa4fc709feb
2022-10-11 10:46:21,738 INFO com.godeltech.springgodelbot.resolver.callback.type.impl.ActivityCallbackType [http-nio-5000-exec-2] Got ACTIVITY callback type with activity :PASSENGER and token : 9a4ca19d9ffaa4fc709feb
2022-10-11 10:46:21,775 INFO com.godeltech.springgodelbot.service.impl.CityServiceImpl [http-nio-5000-exec-2] Find all routes
2022-10-11 10:46:22,806 INFO com.godeltech.springgodelbot.resolver.callback.type.impl.passenger.PassengerRouteCallbackType [http-nio-5000-exec-3] Callback data with type: PASSENGER_ROUTE and routeId: 3 and with token: 9a4ca19d9ffaa4fc709feb
2022-10-11 10:46:23,499 INFO com.godeltech.springgodelbot.resolver.callback.type.impl.passenger.PassengerRouteCallbackType [http-nio-5000-exec-4] Callback data with type: PASSENGER_ROUTE and routeId: 6 and with token: 9a4ca19d9ffaa4fc709feb
2022-10-11 10:46:24,211 INFO com.godeltech.springgodelbot.resolver.callback.type.impl.passenger.ChoseDatePassengerCallbackType [http-nio-5000-exec-5] Callback data with type: CHOSE_DATE_PASSENGER with token : 9a4ca19d9ffaa4fc709feb
2022-10-11 10:46:26,945 INFO com.godeltech.springgodelbot.resolver.callback.type.impl.passenger.FirstDatePassengerCallbackType [http-nio-5000-exec-6] Got FIRST_DATE_PASSENGER type with first date :2022-10-30 with token: 9a4ca19d9ffaa4fc709feb
2022-10-11 10:46:28,033 INFO com.godeltech.springgodelbot.service.impl.OfferServiceImpl [http-nio-5000-exec-7] Find drivers by first date :2022-10-30 and second date:null with cities:[City(id=3, name=WROCLAW), City(id=6, name=GRODNO)]
2022-10-11 10:46:29,597 INFO com.godeltech.springgodelbot.resolver.callback.type.impl.passenger.CheckPassengerCallbackType [http-nio-5000-exec-8] Got callback with type : CHECK_PASSENGER_REQUEST with token : 9a4ca19d9ffaa4fc709feb
2022-10-11 10:46:32,416 INFO com.godeltech.springgodelbot.service.impl.TokenServiceImpl [http-nio-5000-exec-9] Find tokens by userId :834450967
2022-10-11 10:46:32,436 INFO com.godeltech.springgodelbot.resolver.message.type.impl.OnlyTextMessageType [http-nio-5000-exec-9] Got message for saving description of passenger with token :9a4ca19d9ffaa4fc709feb 
2022-10-11 10:46:32,438 INFO com.godeltech.springgodelbot.service.impl.OfferServiceImpl [http-nio-5000-exec-9] Save passenger request : Request(chatId=834450967, userDto=UserDto(id=834450967, firstName=Артем, lastName=Мячин, userName=Myachin97), cities=[City(id=3, name=WROCLAW), City(id=6, name=GRODNO)], firstDate=2022-10-30, secondDate=null, description=Yap yap, needForDescription=true, messages=[704], activity=PASSENGER)
2022-10-11 10:46:32,542 INFO com.godeltech.springgodelbot.service.impl.TudaSudaTelegramBot [http-nio-5000-exec-9] Delete messages with chat id : 834450967 and messages : [704]
2022-10-11 10:46:32,641 INFO com.godeltech.springgodelbot.service.impl.TokenServiceImpl [http-nio-5000-exec-9] Delete token from messages : 9a4ca19d9ffaa4fc709feb
2022-10-11 10:46:32,679 INFO com.godeltech.springgodelbot.service.impl.TokenServiceImpl [http-nio-5000-exec-9] Create new token with userId :834450967 and chatId :834450967
2022-10-11 10:46:32,691 WARN org.hibernate.engine.jdbc.spi.SqlExceptionHelper [http-nio-5000-exec-9] SQL Error: 0, SQLState: 23502
2022-10-11 10:46:32,692 ERROR org.hibernate.engine.jdbc.spi.SqlExceptionHelper [http-nio-5000-exec-9] ERROR: null value in column "message_id" violates not-null constraint
  Detail: Failing row contains (dd488f95e303bf7e49f46e, 834450967, null, 834450967, 2022-10-11 10:46:32.684075, f).
2022-10-11 10:46:32,697 INFO org.hibernate.engine.jdbc.batch.internal.AbstractBatchImpl [http-nio-5000-exec-9] HHH000010: On release of batch it still contained JDBC statements
2022-10-11 10:46:32,715 ERROR com.godeltech.springgodelbot.handler.BotHandler [http-nio-5000-exec-9] could not execute statement; SQL [n/a]; constraint [message_id]; nested exception is org.hibernate.exception.ConstraintViolationException: could not execute statement
2022-10-11 10:49:48,127 INFO org.springframework.orm.jpa.AbstractEntityManagerFactoryBean [SpringApplicationShutdownHook] Closing JPA EntityManagerFactory for persistence unit 'default'
2022-10-11 10:49:48,128 INFO com.zaxxer.hikari.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown initiated...
2022-10-11 10:49:48,136 INFO com.zaxxer.hikari.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown completed.
2022-10-11 10:49:53,159 INFO org.springframework.boot.StartupInfoLogger [main] Starting SpringGodelBotApplication using Java 11.0.12 on INV-2021-L with PID 20848 (C:\Users\a.miachyn\IdeaProjects\SpringGodelBot\target\classes started by a.miachyn in C:\Users\a.miachyn\IdeaProjects\SpringGodelBot)
2022-10-11 10:49:53,159 INFO org.springframework.boot.SpringApplication [main] No active profile set, falling back to 1 default profile: "default"
2022-10-11 10:49:53,714 INFO org.springframework.data.repository.config.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2022-10-11 10:49:53,778 INFO org.springframework.data.repository.config.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 51 ms. Found 4 JPA repository interfaces.
2022-10-11 10:49:54,122 INFO org.springframework.boot.web.embedded.tomcat.TomcatWebServer [main] Tomcat initialized with port(s): 5000 (http)
2022-10-11 10:49:54,137 INFO org.apache.juli.logging.DirectJDKLog [main] Initializing ProtocolHandler ["http-nio-5000"]
2022-10-11 10:49:54,137 INFO org.apache.juli.logging.DirectJDKLog [main] Starting service [Tomcat]
2022-10-11 10:49:54,137 INFO org.apache.juli.logging.DirectJDKLog [main] Starting Servlet engine: [Apache Tomcat/9.0.65]
2022-10-11 10:49:54,215 INFO org.apache.juli.logging.DirectJDKLog [main] Initializing Spring embedded WebApplicationContext
2022-10-11 10:49:54,215 INFO org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext [main] Root WebApplicationContext: initialization completed in 1022 ms
2022-10-11 10:49:54,352 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Starting...
2022-10-11 10:49:54,418 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Start completed.
2022-10-11 10:49:54,509 INFO liquibase.logging.core.JavaLogger [main] Set default schema name to public
2022-10-11 10:49:54,603 INFO liquibase.logging.core.JavaLogger [main] Successfully acquired change log lock
2022-10-11 10:49:54,933 INFO liquibase.logging.core.JavaLogger [main] Reading from public.databasechangelog
2022-10-11 10:49:55,030 INFO liquibase.logging.core.JavaLogger [main] Successfully released change log lock
2022-10-11 10:49:55,033 WARN org.springframework.context.support.AbstractApplicationContext [main] Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'liquibase' defined in class path resource [org/springframework/boot/autoconfigure/liquibase/LiquibaseAutoConfiguration$LiquibaseConfiguration.class]: Invocation of init method failed; nested exception is liquibase.exception.LiquibaseException: liquibase.exception.MigrationFailedException: Migration failed for change set db/changelog/v.0.6/2022-10-10-changes-alter-table-token.xml::2022-10-10-changes-alter-table-token::a.miachyn:
     Reason: liquibase.exception.DatabaseException: ERROR: column "message_id" of relation "token" is an identity column [Failed SQL: (0) ALTER TABLE public.token ALTER COLUMN  message_id DROP NOT NULL]
2022-10-11 10:49:55,033 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Shutdown initiated...
2022-10-11 10:49:55,043 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Shutdown completed.
2022-10-11 10:49:55,046 INFO org.apache.juli.logging.DirectJDKLog [main] Stopping service [Tomcat]
2022-10-11 10:49:55,053 INFO org.springframework.boot.autoconfigure.logging.ConditionEvaluationReportLoggingListener [main] 

Error starting ApplicationContext. To display the conditions report re-run your application with 'debug' enabled.
2022-10-11 10:49:55,059 ERROR org.springframework.boot.SpringApplication [main] Application run failed
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'liquibase' defined in class path resource [org/springframework/boot/autoconfigure/liquibase/LiquibaseAutoConfiguration$LiquibaseConfiguration.class]: Invocation of init method failed; nested exception is liquibase.exception.LiquibaseException: liquibase.exception.MigrationFailedException: Migration failed for change set db/changelog/v.0.6/2022-10-10-changes-alter-table-token.xml::2022-10-10-changes-alter-table-token::a.miachyn:
     Reason: liquibase.exception.DatabaseException: ERROR: column "message_id" of relation "token" is an identity column [Failed SQL: (0) ALTER TABLE public.token ALTER COLUMN  message_id DROP NOT NULL]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1804)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:620)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:542)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:335)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:333)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:208)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:322)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:208)
	at org.springframework.context.support.AbstractApplicationContext.getBean(AbstractApplicationContext.java:1154)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:908)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:583)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:147)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:734)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:408)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:308)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1306)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1295)
	at com.godeltech.springgodelbot.SpringGodelBotApplication.main(SpringGodelBotApplication.java:10)
Caused by: liquibase.exception.LiquibaseException: liquibase.exception.MigrationFailedException: Migration failed for change set db/changelog/v.0.6/2022-10-10-changes-alter-table-token.xml::2022-10-10-changes-alter-table-token::a.miachyn:
     Reason: liquibase.exception.DatabaseException: ERROR: column "message_id" of relation "token" is an identity column [Failed SQL: (0) ALTER TABLE public.token ALTER COLUMN  message_id DROP NOT NULL]
	at liquibase.changelog.ChangeLogIterator.run(ChangeLogIterator.java:126)
	at liquibase.Liquibase.lambda$null$0(Liquibase.java:265)
	at liquibase.Scope.lambda$child$0(Scope.java:180)
	at liquibase.Scope.child(Scope.java:189)
	at liquibase.Scope.child(Scope.java:179)
	at liquibase.Scope.child(Scope.java:158)
	at liquibase.Scope.child(Scope.java:243)
	at liquibase.Liquibase.lambda$update$1(Liquibase.java:264)
	at liquibase.Scope.lambda$child$0(Scope.java:180)
	at liquibase.Scope.child(Scope.java:189)
	at liquibase.Scope.child(Scope.java:179)
	at liquibase.Scope.child(Scope.java:158)
	at liquibase.Liquibase.runInScope(Liquibase.java:2405)
	at liquibase.Liquibase.update(Liquibase.java:211)
	at liquibase.Liquibase.update(Liquibase.java:197)
	at liquibase.integration.spring.SpringLiquibase.performUpdate(SpringLiquibase.java:314)
	at liquibase.integration.spring.SpringLiquibase.afterPropertiesSet(SpringLiquibase.java:269)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1863)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1800)
	... 18 common frames omitted
Caused by: liquibase.exception.MigrationFailedException: Migration failed for change set db/changelog/v.0.6/2022-10-10-changes-alter-table-token.xml::2022-10-10-changes-alter-table-token::a.miachyn:
     Reason: liquibase.exception.DatabaseException: ERROR: column "message_id" of relation "token" is an identity column [Failed SQL: (0) ALTER TABLE public.token ALTER COLUMN  message_id DROP NOT NULL]
	at liquibase.changelog.ChangeSet.execute(ChangeSet.java:696)
	at liquibase.changelog.visitor.UpdateVisitor.visit(UpdateVisitor.java:56)
	at liquibase.changelog.ChangeLogIterator$2.lambda$null$0(ChangeLogIterator.java:113)
	at liquibase.Scope.lambda$child$0(Scope.java:180)
	at liquibase.Scope.child(Scope.java:189)
	at liquibase.Scope.child(Scope.java:179)
	at liquibase.Scope.child(Scope.java:158)
	at liquibase.changelog.ChangeLogIterator$2.lambda$run$1(ChangeLogIterator.java:112)
	at liquibase.Scope.lambda$child$0(Scope.java:180)
	at liquibase.Scope.child(Scope.java:189)
	at liquibase.Scope.child(Scope.java:179)
	at liquibase.Scope.child(Scope.java:158)
	at liquibase.Scope.child(Scope.java:243)
	at liquibase.changelog.ChangeLogIterator$2.run(ChangeLogIterator.java:93)
	at liquibase.Scope.lambda$child$0(Scope.java:180)
	at liquibase.Scope.child(Scope.java:189)
	at liquibase.Scope.child(Scope.java:179)
	at liquibase.Scope.child(Scope.java:158)
	at liquibase.Scope.child(Scope.java:243)
	at liquibase.Scope.child(Scope.java:247)
	at liquibase.changelog.ChangeLogIterator.run(ChangeLogIterator.java:65)
	... 36 common frames omitted
Caused by: liquibase.exception.DatabaseException: ERROR: column "message_id" of relation "token" is an identity column [Failed SQL: (0) ALTER TABLE public.token ALTER COLUMN  message_id DROP NOT NULL]
	at liquibase.executor.jvm.JdbcExecutor$ExecuteStatementCallback.doInStatement(JdbcExecutor.java:397)
	at liquibase.executor.jvm.JdbcExecutor.execute(JdbcExecutor.java:83)
	at liquibase.executor.jvm.JdbcExecutor.execute(JdbcExecutor.java:151)
	at liquibase.database.AbstractJdbcDatabase.execute(AbstractJdbcDatabase.java:1279)
	at liquibase.database.AbstractJdbcDatabase.executeStatements(AbstractJdbcDatabase.java:1261)
	at liquibase.changelog.ChangeSet.execute(ChangeSet.java:661)
	... 56 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column "message_id" of relation "token" is an identity column
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2675)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2365)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:355)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgStatement.executeWithFlags(PgStatement.java:329)
	at org.postgresql.jdbc.PgStatement.executeCachedSql(PgStatement.java:315)
	at org.postgresql.jdbc.PgStatement.executeWithFlags(PgStatement.java:291)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:286)
	at com.zaxxer.hikari.pool.ProxyStatement.execute(ProxyStatement.java:94)
	at com.zaxxer.hikari.pool.HikariProxyStatement.execute(HikariProxyStatement.java)
	at liquibase.executor.jvm.JdbcExecutor$ExecuteStatementCallback.doInStatement(JdbcExecutor.java:393)
	... 61 common frames omitted
2022-10-11 10:52:28,020 INFO org.springframework.boot.StartupInfoLogger [main] Starting SpringGodelBotApplication using Java 11.0.12 on INV-2021-L with PID 24416 (C:\Users\a.miachyn\IdeaProjects\SpringGodelBot\target\classes started by a.miachyn in C:\Users\a.miachyn\IdeaProjects\SpringGodelBot)
2022-10-11 10:52:28,024 INFO org.springframework.boot.SpringApplication [main] No active profile set, falling back to 1 default profile: "default"
2022-10-11 10:52:28,560 INFO org.springframework.data.repository.config.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2022-10-11 10:52:28,629 INFO org.springframework.data.repository.config.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 65 ms. Found 4 JPA repository interfaces.
2022-10-11 10:52:29,045 INFO org.springframework.boot.web.embedded.tomcat.TomcatWebServer [main] Tomcat initialized with port(s): 5000 (http)
2022-10-11 10:52:29,061 INFO org.apache.juli.logging.DirectJDKLog [main] Initializing ProtocolHandler ["http-nio-5000"]
2022-10-11 10:52:29,061 INFO org.apache.juli.logging.DirectJDKLog [main] Starting service [Tomcat]
2022-10-11 10:52:29,061 INFO org.apache.juli.logging.DirectJDKLog [main] Starting Servlet engine: [Apache Tomcat/9.0.65]
2022-10-11 10:52:29,129 INFO org.apache.juli.logging.DirectJDKLog [main] Initializing Spring embedded WebApplicationContext
2022-10-11 10:52:29,129 INFO org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext [main] Root WebApplicationContext: initialization completed in 1064 ms
2022-10-11 10:52:29,244 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Starting...
2022-10-11 10:52:29,322 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Start completed.
2022-10-11 10:52:29,414 INFO liquibase.logging.core.JavaLogger [main] Set default schema name to public
2022-10-11 10:52:29,528 INFO liquibase.logging.core.JavaLogger [main] Successfully acquired change log lock
2022-10-11 10:52:29,794 INFO liquibase.logging.core.JavaLogger [main] Creating database history table with name: public.databasechangelog
2022-10-11 10:52:29,846 INFO liquibase.logging.core.JavaLogger [main] Reading from public.databasechangelog
2022-10-11 10:52:29,973 INFO liquibase.logging.core.JavaLogger [main] Table telegram_user created
2022-10-11 10:52:29,976 INFO liquibase.logging.core.JavaLogger [main] ChangeSet db/changelog/v.0.1/2022-09-06-changes-create-table-user.xml::2022-09-06-changes-create-table-userEntity::a.miachyn ran successfully in 32ms
2022-10-11 10:52:29,997 INFO liquibase.logging.core.JavaLogger [main] Table city created
2022-10-11 10:52:29,999 INFO liquibase.logging.core.JavaLogger [main] ChangeSet db/changelog/v.0.2/2022-09-08-changes-create-table-city.xml::2022-09-08-changes-create-table-city::a.miachyn ran successfully in 17ms
2022-10-11 10:52:30,004 INFO liquibase.logging.core.JavaLogger [main] New row inserted into city
2022-10-11 10:52:30,005 INFO liquibase.logging.core.JavaLogger [main] New row inserted into city
2022-10-11 10:52:30,007 INFO liquibase.logging.core.JavaLogger [main] New row inserted into city
2022-10-11 10:52:30,009 INFO liquibase.logging.core.JavaLogger [main] New row inserted into city
2022-10-11 10:52:30,012 INFO liquibase.logging.core.JavaLogger [main] New row inserted into city
2022-10-11 10:52:30,014 INFO liquibase.logging.core.JavaLogger [main] New row inserted into city
2022-10-11 10:52:30,016 INFO liquibase.logging.core.JavaLogger [main] ChangeSet db/changelog/v.0.2/2022-09-08-changes-filling-table-city.xml::2022-09-08-changes-filling-table-city::a.miachyn ran successfully in 14ms
2022-10-11 10:52:30,028 INFO liquibase.logging.core.JavaLogger [main] Custom SQL executed
2022-10-11 10:52:30,030 INFO liquibase.logging.core.JavaLogger [main] ChangeSet db/changelog/v.0.3/2022-09-11-changes-create-type-activity_type.xml::2022-09-11--create-type-activity_type::a.miachyn ran successfully in 8ms
2022-10-11 10:52:30,051 INFO liquibase.logging.core.JavaLogger [main] Table offer created
2022-10-11 10:52:30,053 INFO liquibase.logging.core.JavaLogger [main] ChangeSet db/changelog/v.0.3/2022-09-11-changes-create-table-offer.xml::2022-09-11-changes-create-table-offer::a.miachyn ran successfully in 19ms
2022-10-11 10:52:30,072 INFO liquibase.logging.core.JavaLogger [main] Table offer_city created
2022-10-11 10:52:30,075 INFO liquibase.logging.core.JavaLogger [main] ChangeSet db/changelog/v.0.3/2022-09-11-changes-create-table-offer-city.xml::2022-09-11-changes-create-table-offer_city::a.miachyn ran successfully in 17ms
2022-10-11 10:52:30,080 INFO liquibase.logging.core.JavaLogger [main] Null constraint dropped from telegram_user.first_name
2022-10-11 10:52:30,082 INFO liquibase.logging.core.JavaLogger [main] Null constraint dropped from telegram_user.last_name
2022-10-11 10:52:30,083 INFO liquibase.logging.core.JavaLogger [main] ChangeSet db/changelog/v.0.4/2022-10-03-changes-alter-table-telegram_user.xml::2022-10-03-changes-alter-table-telegram_user::a.miachyn ran successfully in 4ms
2022-10-11 10:52:30,089 INFO liquibase.logging.core.JavaLogger [main] Null constraint dropped from offer.second_date
2022-10-11 10:52:30,091 INFO liquibase.logging.core.JavaLogger [main] ChangeSet db/changelog/v.0.5/2022-10-07-changes-alter-table-offer-second-date.xml::2022-10-07-changes-alter-table-offer-second-date::a.miachyn ran successfully in 3ms
2022-10-11 10:52:30,109 INFO liquibase.logging.core.JavaLogger [main] Table token created
2022-10-11 10:52:30,111 INFO liquibase.logging.core.JavaLogger [main] ChangeSet db/changelog/v.0.6/2022-10-10-changes-create-table-token.xml::2022-10-10-changes-create-table-token::a.miachyn ran successfully in 16ms
2022-10-11 10:52:30,117 INFO liquibase.logging.core.JavaLogger [main] Successfully released change log lock
2022-10-11 10:52:30,185 INFO org.hibernate.jpa.internal.util.LogHelper [main] HHH000204: Processing PersistenceUnitInfo [name: default]
2022-10-11 10:52:30,203 INFO org.hibernate.Version [main] HHH000412: Hibernate ORM core version 5.6.10.Final
2022-10-11 10:52:30,286 INFO org.hibernate.annotations.common.reflection.java.JavaReflectionManager [main] HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2022-10-11 10:52:30,344 INFO org.hibernate.dialect.Dialect [main] HHH000400: Using dialect: org.hibernate.dialect.PostgreSQL10Dialect
2022-10-11 10:52:30,691 INFO org.hibernate.engine.transaction.jta.platform.internal.JtaPlatformInitiator [main] HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2022-10-11 10:52:30,691 INFO org.springframework.orm.jpa.AbstractEntityManagerFactoryBean [main] Initialized JPA EntityManagerFactory for persistence unit 'default'
2022-10-11 10:52:31,220 WARN org.springframework.boot.autoconfigure.orm.jpa.JpaBaseConfiguration$JpaWebConfiguration [main] spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2022-10-11 10:52:31,419 INFO org.apache.juli.logging.DirectJDKLog [main] Starting ProtocolHandler ["http-nio-5000"]
2022-10-11 10:52:31,429 INFO org.springframework.boot.web.embedded.tomcat.TomcatWebServer [main] Tomcat started on port(s): 5000 (http) with context path ''
2022-10-11 10:52:31,445 INFO com.godeltech.springgodelbot.scheduler.impl.ScheduleServiceImpl [scheduling-1] Deleting expired offers
2022-10-11 10:52:31,445 INFO com.godeltech.springgodelbot.config.BotInitializer [main] Set web hook with path :https://1561-82-209-241-194.eu.ngrok.io
2022-10-11 10:52:31,445 INFO com.godeltech.springgodelbot.service.impl.RestServiceImpl [main] Set webhook with path :https://1561-82-209-241-194.eu.ngrok.io
2022-10-11 10:52:31,466 INFO com.godeltech.springgodelbot.service.impl.OfferServiceImpl [scheduling-1] Delete offers whose second date is earlier than : 2022-10-11
2022-10-11 10:52:31,543 INFO com.godeltech.springgodelbot.service.impl.OfferServiceImpl [scheduling-1] Delete offers whose first date is earlier than :2022-10-11 and second date is null
2022-10-11 10:52:31,550 INFO com.godeltech.springgodelbot.scheduler.impl.ScheduleServiceImpl [scheduling-1] Deleting expired offers
2022-10-11 10:52:31,554 INFO com.godeltech.springgodelbot.service.impl.TokenServiceImpl [scheduling-1] Remove expired token
2022-10-11 10:52:32,135 INFO org.springframework.boot.StartupInfoLogger [main] Started SpringGodelBotApplication in 4.502 seconds (JVM running for 5.429)
2022-10-11 10:52:36,733 INFO org.apache.juli.logging.DirectJDKLog [http-nio-5000-exec-1] Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-10-11 10:52:36,733 INFO org.springframework.web.servlet.FrameworkServlet [http-nio-5000-exec-1] Initializing Servlet 'dispatcherServlet'
2022-10-11 10:52:36,749 INFO org.springframework.web.servlet.FrameworkServlet [http-nio-5000-exec-1] Completed initialization in 16 ms
2022-10-11 10:52:36,997 INFO com.godeltech.springgodelbot.resolver.message.type.impl.TextAndEntityMessageType [http-nio-5000-exec-1] Got /start message
2022-10-11 10:52:37,014 INFO com.godeltech.springgodelbot.service.impl.TudaSudaTelegramBot [http-nio-5000-exec-1] Is he member of group?
2022-10-11 10:52:37,125 INFO com.godeltech.springgodelbot.service.impl.UserServiceImpl [http-nio-5000-exec-1] Check existing of user by id: 834450967
2022-10-11 10:52:37,170 INFO com.godeltech.springgodelbot.service.impl.UserServiceImpl [http-nio-5000-exec-1] Save a new user: UserEntity(id=834450967, firstName=Артем, lastName=Мячин, userName=Myachin97)
2022-10-11 10:52:37,274 INFO com.godeltech.springgodelbot.service.impl.TokenServiceImpl [http-nio-5000-exec-1] Create new token with userId :834450967, messageId: 706 and chatId :834450967
2022-10-11 10:52:39,315 INFO com.godeltech.springgodelbot.service.impl.TokenServiceImpl [http-nio-5000-exec-2] Income message with token :a64b64ba498bd67d82cb14
2022-10-11 10:52:39,350 INFO com.godeltech.springgodelbot.resolver.callback.type.impl.ActivityCallbackType [http-nio-5000-exec-2] Got ACTIVITY callback type with activity :PASSENGER and token : a64b64ba498bd67d82cb14
2022-10-11 10:52:39,382 INFO com.godeltech.springgodelbot.service.impl.CityServiceImpl [http-nio-5000-exec-2] Find all routes
2022-10-11 10:52:40,250 INFO com.godeltech.springgodelbot.resolver.callback.type.impl.passenger.PassengerRouteCallbackType [http-nio-5000-exec-3] Callback data with type: PASSENGER_ROUTE and routeId: 4 and with token: a64b64ba498bd67d82cb14
2022-10-11 10:52:41,333 INFO com.godeltech.springgodelbot.resolver.callback.type.impl.passenger.PassengerRouteCallbackType [http-nio-5000-exec-4] Callback data with type: PASSENGER_ROUTE and routeId: 6 and with token: a64b64ba498bd67d82cb14
2022-10-11 10:52:41,999 INFO com.godeltech.springgodelbot.resolver.callback.type.impl.passenger.ChoseDatePassengerCallbackType [http-nio-5000-exec-5] Callback data with type: CHOSE_DATE_PASSENGER with token : a64b64ba498bd67d82cb14
2022-10-11 10:52:43,267 INFO com.godeltech.springgodelbot.resolver.callback.type.impl.passenger.FirstDatePassengerCallbackType [http-nio-5000-exec-6] Got FIRST_DATE_PASSENGER type with first date :2022-10-30 with token: a64b64ba498bd67d82cb14
2022-10-11 10:52:44,626 INFO com.godeltech.springgodelbot.service.impl.OfferServiceImpl [http-nio-5000-exec-7] Find drivers by first date :2022-10-30 and second date:null with cities:[City(id=4, name=GDANSK), City(id=6, name=GRODNO)]
2022-10-11 10:52:46,964 INFO com.godeltech.springgodelbot.resolver.callback.type.impl.passenger.CheckPassengerCallbackType [http-nio-5000-exec-8] Got callback with type : CHECK_PASSENGER_REQUEST with token : a64b64ba498bd67d82cb14
2022-10-11 10:52:49,674 INFO com.godeltech.springgodelbot.service.impl.TokenServiceImpl [http-nio-5000-exec-9] Find tokens by userId :834450967
2022-10-11 10:52:49,691 INFO com.godeltech.springgodelbot.resolver.message.type.impl.OnlyTextMessageType [http-nio-5000-exec-9] Got message for saving description of passenger with token :a64b64ba498bd67d82cb14 
2022-10-11 10:52:49,693 INFO com.godeltech.springgodelbot.service.impl.OfferServiceImpl [http-nio-5000-exec-9] Save passenger request : Request(chatId=834450967, userDto=UserDto(id=834450967, firstName=Артем, lastName=Мячин, userName=Myachin97), cities=[City(id=4, name=GDANSK), City(id=6, name=GRODNO)], firstDate=2022-10-30, secondDate=null, description=yapyap, needForDescription=true, messages=[707], activity=PASSENGER)
2022-10-11 10:52:49,776 INFO com.godeltech.springgodelbot.service.impl.TudaSudaTelegramBot [http-nio-5000-exec-9] Delete messages with chat id : 834450967 and messages : [707]
2022-10-11 10:52:49,852 INFO com.godeltech.springgodelbot.service.impl.TokenServiceImpl [http-nio-5000-exec-9] Delete token from messages : a64b64ba498bd67d82cb14
2022-10-11 10:52:49,870 INFO com.godeltech.springgodelbot.service.impl.TokenServiceImpl [http-nio-5000-exec-9] Create new token with userId :834450967 and chatId :834450967
2022-10-11 10:53:19,608 INFO com.godeltech.springgodelbot.service.impl.TokenServiceImpl [http-nio-5000-exec-10] Income message with token :194c4d9d98d0edd4618392
2022-10-11 10:53:19,632 INFO com.godeltech.springgodelbot.resolver.callback.type.impl.ActivityCallbackType [http-nio-5000-exec-10] Got ACTIVITY callback type with activity :DRIVER and token : 194c4d9d98d0edd4618392
2022-10-11 10:53:30,713 INFO com.godeltech.springgodelbot.resolver.callback.type.impl.driver.DriverRouteCallbackType [http-nio-5000-exec-1] Callback data with type: DRIVER_ROUTE and routeId: 3 and token: 194c4d9d98d0edd4618392
2022-10-11 10:53:31,329 INFO com.godeltech.springgodelbot.resolver.callback.type.impl.driver.DriverRouteCallbackType [http-nio-5000-exec-2] Callback data with type: DRIVER_ROUTE and routeId: 5 and token: 194c4d9d98d0edd4618392
2022-10-11 10:53:32,549 INFO com.godeltech.springgodelbot.resolver.callback.type.impl.driver.ChoseDateDriverCallbackType [http-nio-5000-exec-3] Callback data with type: CHOSE_DATE_DRIVER with token : 194c4d9d98d0edd4618392
2022-10-11 10:53:34,350 INFO com.godeltech.springgodelbot.resolver.callback.type.impl.driver.FirstDateDriverCallbackType [http-nio-5000-exec-4] Got FIRST_DATE_DRIVER callback type with first date :2022-11-03 with token: 194c4d9d98d0edd4618392
2022-10-11 10:53:35,434 INFO com.godeltech.springgodelbot.service.impl.OfferServiceImpl [http-nio-5000-exec-5] Find passengers by first date :2022-11-03 and second date:null with cities:[City(id=3, name=WROCLAW), City(id=5, name=BREST)]
2022-10-11 10:53:36,763 INFO com.godeltech.springgodelbot.resolver.callback.type.impl.driver.CheckDriverCallbackType [http-nio-5000-exec-6] Got callback type :CHECK_DRIVER_REQUEST with token :194c4d9d98d0edd4618392
2022-10-11 10:53:39,911 INFO com.godeltech.springgodelbot.service.impl.TokenServiceImpl [http-nio-5000-exec-7] Find tokens by userId :834450967
2022-10-11 10:53:39,919 INFO com.godeltech.springgodelbot.resolver.message.type.impl.OnlyTextMessageType [http-nio-5000-exec-7] Got message for saving description of driver with token :194c4d9d98d0edd4618392 
2022-10-11 10:53:39,920 INFO com.godeltech.springgodelbot.service.impl.TudaSudaTelegramBot [http-nio-5000-exec-7] Delete messages with chat id : 834450967 and messages : [709]
2022-10-11 10:53:40,072 INFO com.godeltech.springgodelbot.service.impl.OfferServiceImpl [http-nio-5000-exec-7] Save supplier by: Request(chatId=834450967, userDto=UserDto(id=834450967, firstName=Артем, lastName=Мячин, userName=Myachin97), cities=[City(id=3, name=WROCLAW), City(id=5, name=BREST)], firstDate=2022-11-03, secondDate=null, description=Okay, needForDescription=true, messages=[709], activity=DRIVER)
2022-10-11 10:53:40,123 INFO com.godeltech.springgodelbot.service.impl.TokenServiceImpl [http-nio-5000-exec-7] Delete token from messages : 194c4d9d98d0edd4618392
2022-10-11 10:53:40,139 INFO com.godeltech.springgodelbot.service.impl.TokenServiceImpl [http-nio-5000-exec-7] Create new token with userId :834450967 and chatId :834450967
2022-10-11 10:53:54,119 INFO com.godeltech.springgodelbot.resolver.callback.type.impl.offer.OffersActivityCallbackType [http-nio-5000-exec-8] Got OFFERS_ACTIVITY callback type
2022-10-11 10:53:54,124 INFO com.godeltech.springgodelbot.service.impl.TokenServiceImpl [http-nio-5000-exec-8] Income message with token :974b3a98d4c2b47baf8091
2022-10-11 10:53:55,109 INFO com.godeltech.springgodelbot.resolver.callback.type.impl.offer.MyOffersCallbackType [http-nio-5000-exec-9] Callback with type :MY_OFFERS and activity : DRIVER and token: 974b3a98d4c2b47baf8091
2022-10-11 10:53:55,114 INFO com.godeltech.springgodelbot.service.impl.OfferServiceImpl [http-nio-5000-exec-9] Find offers by id:834450967 and activity :DRIVER
2022-10-11 10:53:56,060 INFO com.godeltech.springgodelbot.resolver.callback.type.impl.offer.ChangeOfferCallbackType [http-nio-5000-exec-10] Got CHANGE_OFFER callback type with route id :2 and token: 974b3a98d4c2b47baf8091
2022-10-11 10:53:56,066 INFO com.godeltech.springgodelbot.service.impl.OfferServiceImpl [http-nio-5000-exec-10] Find offer by id : 2
2022-10-11 10:53:58,203 INFO com.godeltech.springgodelbot.resolver.callback.type.impl.offer.ChangeDescriptionOfOfferCallbackType [http-nio-5000-exec-1] Change description of offer with id: 2 and token : 974b3a98d4c2b47baf8091
2022-10-11 10:54:01,506 INFO com.godeltech.springgodelbot.service.impl.TokenServiceImpl [http-nio-5000-exec-2] Find tokens by userId :834450967
2022-10-11 10:54:01,514 INFO com.godeltech.springgodelbot.resolver.message.type.impl.OnlyTextMessageType [http-nio-5000-exec-2] Got message for changing description of offer with token 
2022-10-11 10:54:01,515 INFO com.godeltech.springgodelbot.service.impl.OfferServiceImpl [http-nio-5000-exec-2] Update description of offer with id : 2
2022-10-11 10:54:01,516 INFO com.godeltech.springgodelbot.service.impl.OfferServiceImpl [http-nio-5000-exec-2] Get offer by id: 2
2022-10-11 10:54:01,536 INFO com.godeltech.springgodelbot.service.impl.TudaSudaTelegramBot [http-nio-5000-exec-2] Delete messages with chat id : 834450967 and messages : [711]
2022-10-11 10:54:01,801 INFO com.godeltech.springgodelbot.service.impl.TokenServiceImpl [http-nio-5000-exec-2] Delete token from messages : 974b3a98d4c2b47baf8091
2022-10-11 10:54:01,824 INFO com.godeltech.springgodelbot.service.impl.TokenServiceImpl [http-nio-5000-exec-2] Create new token with userId :834450967 and chatId :834450967
2022-10-11 10:54:03,776 INFO com.godeltech.springgodelbot.resolver.callback.type.impl.offer.OffersActivityCallbackType [http-nio-5000-exec-3] Got OFFERS_ACTIVITY callback type
2022-10-11 10:54:03,781 INFO com.godeltech.springgodelbot.service.impl.TokenServiceImpl [http-nio-5000-exec-3] Income message with token :9642b6be25fbdad5e4960e
2022-10-11 10:54:04,665 INFO com.godeltech.springgodelbot.resolver.callback.type.impl.offer.MyOffersCallbackType [http-nio-5000-exec-4] Callback with type :MY_OFFERS and activity : PASSENGER and token: 9642b6be25fbdad5e4960e
2022-10-11 10:54:04,671 INFO com.godeltech.springgodelbot.service.impl.OfferServiceImpl [http-nio-5000-exec-4] Find offers by id:834450967 and activity :PASSENGER
2022-10-11 10:54:05,540 INFO com.godeltech.springgodelbot.resolver.callback.type.impl.offer.ChangeOfferCallbackType [http-nio-5000-exec-5] Got CHANGE_OFFER callback type with route id :1 and token: 9642b6be25fbdad5e4960e
2022-10-11 10:54:05,546 INFO com.godeltech.springgodelbot.service.impl.OfferServiceImpl [http-nio-5000-exec-5] Find offer by id : 1
2022-10-11 10:54:07,561 INFO com.godeltech.springgodelbot.resolver.callback.type.impl.offer.ChangeDescriptionOfOfferCallbackType [http-nio-5000-exec-6] Change description of offer with id: 1 and token : 9642b6be25fbdad5e4960e
2022-10-11 10:54:11,183 INFO com.godeltech.springgodelbot.service.impl.TokenServiceImpl [http-nio-5000-exec-7] Find tokens by userId :834450967
2022-10-11 10:54:11,192 INFO com.godeltech.springgodelbot.resolver.message.type.impl.OnlyTextMessageType [http-nio-5000-exec-7] Got message for changing description of offer with token 
2022-10-11 10:54:11,194 INFO com.godeltech.springgodelbot.service.impl.OfferServiceImpl [http-nio-5000-exec-7] Update description of offer with id : 1
2022-10-11 10:54:11,194 INFO com.godeltech.springgodelbot.service.impl.OfferServiceImpl [http-nio-5000-exec-7] Get offer by id: 1
2022-10-11 10:54:11,221 INFO com.godeltech.springgodelbot.service.impl.TudaSudaTelegramBot [http-nio-5000-exec-7] Delete messages with chat id : 834450967 and messages : [713]
2022-10-11 10:54:11,298 INFO com.godeltech.springgodelbot.service.impl.TokenServiceImpl [http-nio-5000-exec-7] Delete token from messages : 9642b6be25fbdad5e4960e
2022-10-11 10:54:11,317 INFO com.godeltech.springgodelbot.service.impl.TokenServiceImpl [http-nio-5000-exec-7] Create new token with userId :834450967 and chatId :834450967
2022-10-11 10:54:23,232 INFO com.godeltech.springgodelbot.resolver.callback.type.impl.offer.OffersActivityCallbackType [http-nio-5000-exec-8] Got OFFERS_ACTIVITY callback type
2022-10-11 10:54:23,237 INFO com.godeltech.springgodelbot.service.impl.TokenServiceImpl [http-nio-5000-exec-8] Income message with token :cc45f68f80c21a4e7f73f4
2022-10-11 10:54:24,023 INFO com.godeltech.springgodelbot.resolver.callback.type.impl.offer.MyOffersCallbackType [http-nio-5000-exec-9] Callback with type :MY_OFFERS and activity : PASSENGER and token: cc45f68f80c21a4e7f73f4
2022-10-11 10:54:24,028 INFO com.godeltech.springgodelbot.service.impl.OfferServiceImpl [http-nio-5000-exec-9] Find offers by id:834450967 and activity :PASSENGER
2022-10-11 10:54:24,855 INFO com.godeltech.springgodelbot.resolver.callback.type.impl.offer.ChangeOfferCallbackType [http-nio-5000-exec-10] Got CHANGE_OFFER callback type with route id :1 and token: cc45f68f80c21a4e7f73f4
2022-10-11 10:54:24,859 INFO com.godeltech.springgodelbot.service.impl.OfferServiceImpl [http-nio-5000-exec-10] Find offer by id : 1
2022-10-11 10:54:25,941 INFO com.godeltech.springgodelbot.resolver.callback.type.impl.offer.ChangeDateOfOfferCallbackType [http-nio-5000-exec-1] Got CHANGE_DATE_OF_OFFER type with token: cc45f68f80c21a4e7f73f4
2022-10-11 10:54:25,942 INFO com.godeltech.springgodelbot.resolver.callback.type.impl.offer.ChangeDateOfOfferCallbackType [http-nio-5000-exec-1] Change date of offer with id:1, with token :cc45f68f80c21a4e7f73f4
2022-10-11 10:54:26,990 INFO com.godeltech.springgodelbot.resolver.callback.type.impl.offer.ChangeFirstDateOfOfferCallbackType [http-nio-5000-exec-2] Change the first date of offer, changed first date: 2022-11-02 and token : cc45f68f80c21a4e7f73f4
2022-10-11 10:54:29,646 INFO com.godeltech.springgodelbot.resolver.callback.type.impl.offer.FinishChangeDateOfferCallbackType [http-nio-5000-exec-3] Got FINISH_DATE_OFFER callback type with token : cc45f68f80c21a4e7f73f4
2022-10-11 10:54:29,650 INFO com.godeltech.springgodelbot.service.impl.OfferServiceImpl [http-nio-5000-exec-3] Update date of offer with first date : 2022-11-02 , and second date : null 
2022-10-11 10:54:29,650 INFO com.godeltech.springgodelbot.service.impl.OfferServiceImpl [http-nio-5000-exec-3] Get offer by id: 1
2022-10-11 10:54:29,666 INFO com.godeltech.springgodelbot.service.impl.OfferServiceImpl [http-nio-5000-exec-3] Find drivers by first date :2022-11-02 and second date:null with cities:[City(id=4, name=GDANSK), City(id=6, name=GRODNO)]
2022-10-11 10:54:33,681 INFO com.godeltech.springgodelbot.resolver.callback.type.impl.MainMenuActivityCallbackType [http-nio-5000-exec-4] Got MAIN_MENU callback type
2022-10-11 10:54:33,682 INFO com.godeltech.springgodelbot.service.impl.TudaSudaTelegramBot [http-nio-5000-exec-4] Is he member of group?
2022-10-11 10:54:33,769 INFO com.godeltech.springgodelbot.service.impl.UserServiceImpl [http-nio-5000-exec-4] Check existing of user by id: 834450967
2022-10-11 10:54:33,778 INFO com.godeltech.springgodelbot.service.impl.TokenServiceImpl [http-nio-5000-exec-4] Delete token from messages : cc45f68f80c21a4e7f73f4
2022-10-11 10:54:33,800 INFO com.godeltech.springgodelbot.service.impl.TokenServiceImpl [http-nio-5000-exec-4] Create new token with userId :834450967, messageId: 715 and chatId :834450967
2022-10-11 10:54:34,718 INFO com.godeltech.springgodelbot.resolver.callback.type.impl.offer.OffersActivityCallbackType [http-nio-5000-exec-5] Got OFFERS_ACTIVITY callback type
2022-10-11 10:54:34,724 INFO com.godeltech.springgodelbot.service.impl.TokenServiceImpl [http-nio-5000-exec-5] Income message with token :d04e8cb0d58ca1cca1bd42
2022-10-11 10:55:00,107 INFO com.godeltech.springgodelbot.resolver.callback.type.impl.offer.MyOffersCallbackType [http-nio-5000-exec-6] Callback with type :MY_OFFERS and activity : PASSENGER and token: d04e8cb0d58ca1cca1bd42
2022-10-11 10:55:00,111 INFO com.godeltech.springgodelbot.service.impl.OfferServiceImpl [http-nio-5000-exec-6] Find offers by id:834450967 and activity :PASSENGER
2022-10-11 10:55:00,963 INFO com.godeltech.springgodelbot.resolver.callback.type.impl.offer.ChangeOfferCallbackType [http-nio-5000-exec-7] Got CHANGE_OFFER callback type with route id :1 and token: d04e8cb0d58ca1cca1bd42
2022-10-11 10:55:00,966 INFO com.godeltech.springgodelbot.service.impl.OfferServiceImpl [http-nio-5000-exec-7] Find offer by id : 1
2022-10-11 10:55:02,357 INFO com.godeltech.springgodelbot.resolver.callback.type.impl.offer.ChangeRouteOfOfferCallbackType [http-nio-5000-exec-8] Callback data with type: CHANGE_ROUTE_OF_OFFER with token: d04e8cb0d58ca1cca1bd42
2022-10-11 10:55:03,709 INFO com.godeltech.springgodelbot.resolver.callback.type.impl.offer.CancelRouteOfOfferCallbackType [http-nio-5000-exec-9] Callback data with type: CANCEL_ROUTE_OF_OFFER and routeId: 4 and token : d04e8cb0d58ca1cca1bd42
2022-10-11 10:55:04,909 INFO com.godeltech.springgodelbot.resolver.callback.type.impl.offer.CancelRouteOfOfferCallbackType [http-nio-5000-exec-10] Callback data with type: CANCEL_ROUTE_OF_OFFER and routeId: 6 and token : d04e8cb0d58ca1cca1bd42
2022-10-11 10:55:05,525 INFO com.godeltech.springgodelbot.resolver.callback.type.impl.offer.ChangeRouteOfOfferCallbackType [http-nio-5000-exec-1] Callback data with type: CHANGE_ROUTE_OF_OFFER with token: d04e8cb0d58ca1cca1bd42
2022-10-11 10:55:06,128 INFO com.godeltech.springgodelbot.resolver.callback.type.impl.offer.ChangeRouteOfOfferCallbackType [http-nio-5000-exec-2] Callback data with type: CHANGE_ROUTE_OF_OFFER with token: d04e8cb0d58ca1cca1bd42
2022-10-11 10:55:07,102 INFO com.godeltech.springgodelbot.resolver.callback.type.impl.offer.FinishChangeRouteOfOfferCallbackType [http-nio-5000-exec-3] Got callback type :FINISH_CHANGING_ROUTE_OF_OFFER, with token:d04e8cb0d58ca1cca1bd42
2022-10-11 10:55:07,104 INFO com.godeltech.springgodelbot.service.impl.RequestServiceImpl [http-nio-5000-exec-3] Update route of offer with id :1
2022-10-11 10:55:07,107 INFO com.godeltech.springgodelbot.service.impl.OfferServiceImpl [http-nio-5000-exec-3] Update cities of offer with id : 1 and cities : [City(id=2, name=BELASTOK), City(id=4, name=GDANSK)] 
2022-10-11 10:55:07,108 INFO com.godeltech.springgodelbot.service.impl.OfferServiceImpl [http-nio-5000-exec-3] Get offer by id: 1
2022-10-11 10:55:07,142 INFO com.godeltech.springgodelbot.service.impl.OfferServiceImpl [http-nio-5000-exec-3] Find drivers by first date :2022-11-02 and second date:null with cities:[City(id=2, name=BELASTOK), City(id=4, name=GDANSK)]
2022-10-11 10:55:07,148 INFO com.godeltech.springgodelbot.service.impl.TokenServiceImpl [http-nio-5000-exec-3] Delete token from messages : d04e8cb0d58ca1cca1bd42
2022-10-11 10:55:12,033 INFO com.godeltech.springgodelbot.service.impl.TokenServiceImpl [http-nio-5000-exec-4] Find tokens by userId :834450967
2022-10-11 10:55:12,043 INFO com.godeltech.springgodelbot.service.impl.TudaSudaTelegramBot [http-nio-5000-exec-4] Is he member of group?
2022-10-11 10:55:12,247 ERROR com.godeltech.springgodelbot.handler.BotHandler [http-nio-5000-exec-4] null
2022-10-11 10:55:14,091 INFO com.godeltech.springgodelbot.resolver.callback.type.impl.MainMenuActivityCallbackType [http-nio-5000-exec-5] Got MAIN_MENU callback type
2022-10-11 10:55:14,092 INFO com.godeltech.springgodelbot.service.impl.TudaSudaTelegramBot [http-nio-5000-exec-5] Is he member of group?
2022-10-11 10:55:14,156 INFO com.godeltech.springgodelbot.service.impl.UserServiceImpl [http-nio-5000-exec-5] Check existing of user by id: 834450967
2022-10-11 10:55:14,165 INFO com.godeltech.springgodelbot.service.impl.TokenServiceImpl [http-nio-5000-exec-5] Delete token from messages : d04e8cb0d58ca1cca1bd42
2022-10-11 10:55:14,174 ERROR com.godeltech.springgodelbot.handler.BotHandler [http-nio-5000-exec-5] class com.godeltech.springgodelbot.model.entity.Token wasn't found by id=d04e8cb0d58ca1cca1bd42
2022-10-11 10:55:14,174 INFO com.godeltech.springgodelbot.service.impl.TokenServiceImpl [http-nio-5000-exec-5] Create new token with userId :5632797057, messageId: 715 and chatId :834450967
2022-10-11 10:55:35,313 INFO com.godeltech.springgodelbot.resolver.callback.type.impl.offer.OffersActivityCallbackType [http-nio-5000-exec-6] Got OFFERS_ACTIVITY callback type
2022-10-11 10:55:35,318 INFO com.godeltech.springgodelbot.service.impl.TokenServiceImpl [http-nio-5000-exec-6] Income message with token :b54b60aa34dfde003bac6c
2022-10-11 10:55:41,472 INFO com.godeltech.springgodelbot.resolver.callback.type.impl.offer.MyOffersCallbackType [http-nio-5000-exec-7] Callback with type :MY_OFFERS and activity : DRIVER and token: b54b60aa34dfde003bac6c
2022-10-11 10:55:41,476 INFO com.godeltech.springgodelbot.service.impl.OfferServiceImpl [http-nio-5000-exec-7] Find offers by id:834450967 and activity :DRIVER
2022-10-11 10:55:42,406 INFO com.godeltech.springgodelbot.resolver.callback.type.impl.offer.ChangeOfferCallbackType [http-nio-5000-exec-8] Got CHANGE_OFFER callback type with route id :2 and token: b54b60aa34dfde003bac6c
2022-10-11 10:55:42,410 INFO com.godeltech.springgodelbot.service.impl.OfferServiceImpl [http-nio-5000-exec-8] Find offer by id : 2
2022-10-11 10:55:44,178 INFO com.godeltech.springgodelbot.resolver.callback.type.impl.offer.DeleteOfferCallbackType [http-nio-5000-exec-9] Delete offer by id :2 and token: b54b60aa34dfde003bac6c
2022-10-11 10:55:44,181 INFO com.godeltech.springgodelbot.service.impl.OfferServiceImpl [http-nio-5000-exec-9] Delete offer by id : 2
2022-10-11 10:55:44,182 INFO com.godeltech.springgodelbot.service.impl.OfferServiceImpl [http-nio-5000-exec-9] Get offer by id: 2
2022-10-11 10:55:44,209 INFO com.godeltech.springgodelbot.service.impl.TokenServiceImpl [http-nio-5000-exec-9] Delete token from messages : b54b60aa34dfde003bac6c
2022-10-11 10:55:44,217 INFO com.godeltech.springgodelbot.service.impl.TokenServiceImpl [http-nio-5000-exec-9] Create new token with userId :834450967, messageId: 717 and chatId :834450967
2022-10-11 10:55:45,052 INFO com.godeltech.springgodelbot.resolver.callback.type.impl.offer.OffersActivityCallbackType [http-nio-5000-exec-10] Got OFFERS_ACTIVITY callback type
2022-10-11 10:55:45,055 INFO com.godeltech.springgodelbot.service.impl.TokenServiceImpl [http-nio-5000-exec-10] Income message with token :3143229d2513a6115ce0e1
2022-10-11 10:55:45,706 INFO com.godeltech.springgodelbot.resolver.callback.type.impl.offer.MyOffersCallbackType [http-nio-5000-exec-1] Callback with type :MY_OFFERS and activity : PASSENGER and token: 3143229d2513a6115ce0e1
2022-10-11 10:55:45,711 INFO com.godeltech.springgodelbot.service.impl.OfferServiceImpl [http-nio-5000-exec-1] Find offers by id:834450967 and activity :PASSENGER
2022-10-11 10:55:46,529 INFO com.godeltech.springgodelbot.resolver.callback.type.impl.offer.CancelChangeOfferRequest [http-nio-5000-exec-2] Got callback : CANCEL_CHANGE_OFFER_REQUEST with token : 3143229d2513a6115ce0e1
2022-10-11 10:55:46,533 INFO com.godeltech.springgodelbot.service.impl.TokenServiceImpl [http-nio-5000-exec-2] Delete token from messages : 3143229d2513a6115ce0e1
2022-10-11 10:55:46,626 INFO com.godeltech.springgodelbot.service.impl.TokenServiceImpl [http-nio-5000-exec-2] Create new token with userId :834450967, messageId: 717 and chatId :834450967
2022-10-11 10:55:47,442 INFO com.godeltech.springgodelbot.resolver.callback.type.impl.offer.OffersActivityCallbackType [http-nio-5000-exec-3] Got OFFERS_ACTIVITY callback type
2022-10-11 10:55:47,447 INFO com.godeltech.springgodelbot.service.impl.TokenServiceImpl [http-nio-5000-exec-3] Income message with token :864ca6bef7010031e0f4ce
2022-10-11 10:55:48,097 INFO com.godeltech.springgodelbot.resolver.callback.type.impl.offer.MyOffersCallbackType [http-nio-5000-exec-4] Callback with type :MY_OFFERS and activity : DRIVER and token: 864ca6bef7010031e0f4ce
2022-10-11 10:55:48,100 INFO com.godeltech.springgodelbot.service.impl.OfferServiceImpl [http-nio-5000-exec-4] Find offers by id:834450967 and activity :DRIVER
2022-10-11 10:55:48,869 INFO com.godeltech.springgodelbot.resolver.callback.type.impl.MainMenuActivityCallbackType [http-nio-5000-exec-5] Got MAIN_MENU callback type
2022-10-11 10:55:48,869 INFO com.godeltech.springgodelbot.service.impl.TudaSudaTelegramBot [http-nio-5000-exec-5] Is he member of group?
2022-10-11 10:55:48,938 INFO com.godeltech.springgodelbot.service.impl.UserServiceImpl [http-nio-5000-exec-5] Check existing of user by id: 834450967
2022-10-11 10:55:48,946 INFO com.godeltech.springgodelbot.service.impl.TokenServiceImpl [http-nio-5000-exec-5] Delete token from messages : 864ca6bef7010031e0f4ce
2022-10-11 10:55:48,965 INFO com.godeltech.springgodelbot.service.impl.TokenServiceImpl [http-nio-5000-exec-5] Create new token with userId :834450967, messageId: 718 and chatId :834450967
2022-10-11 11:07:50,950 INFO org.springframework.orm.jpa.AbstractEntityManagerFactoryBean [SpringApplicationShutdownHook] Closing JPA EntityManagerFactory for persistence unit 'default'
2022-10-11 11:07:50,950 INFO com.zaxxer.hikari.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown initiated...
2022-10-11 11:07:50,962 INFO com.zaxxer.hikari.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown completed.
2022-10-11 11:07:56,362 INFO org.springframework.boot.StartupInfoLogger [main] Starting SpringGodelBotApplication using Java 11.0.12 on INV-2021-L with PID 14792 (C:\Users\a.miachyn\IdeaProjects\SpringGodelBot\target\classes started by a.miachyn in C:\Users\a.miachyn\IdeaProjects\SpringGodelBot)
2022-10-11 11:07:56,362 INFO org.springframework.boot.SpringApplication [main] No active profile set, falling back to 1 default profile: "default"
2022-10-11 11:07:56,954 INFO org.springframework.data.repository.config.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2022-10-11 11:07:57,017 INFO org.springframework.data.repository.config.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 68 ms. Found 4 JPA repository interfaces.
2022-10-11 11:07:57,436 INFO org.springframework.boot.web.embedded.tomcat.TomcatWebServer [main] Tomcat initialized with port(s): 5000 (http)
2022-10-11 11:07:57,436 INFO org.apache.juli.logging.DirectJDKLog [main] Initializing ProtocolHandler ["http-nio-5000"]
2022-10-11 11:07:57,436 INFO org.apache.juli.logging.DirectJDKLog [main] Starting service [Tomcat]
2022-10-11 11:07:57,436 INFO org.apache.juli.logging.DirectJDKLog [main] Starting Servlet engine: [Apache Tomcat/9.0.65]
2022-10-11 11:07:57,531 INFO org.apache.juli.logging.DirectJDKLog [main] Initializing Spring embedded WebApplicationContext
2022-10-11 11:07:57,531 INFO org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext [main] Root WebApplicationContext: initialization completed in 1140 ms
2022-10-11 11:07:57,703 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Starting...
2022-10-11 11:07:57,785 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Start completed.
2022-10-11 11:07:57,880 INFO liquibase.logging.core.JavaLogger [main] Set default schema name to public
2022-10-11 11:07:57,982 INFO liquibase.logging.core.JavaLogger [main] Successfully acquired change log lock
2022-10-11 11:07:58,338 INFO liquibase.logging.core.JavaLogger [main] Reading from public.databasechangelog
2022-10-11 11:07:58,421 INFO liquibase.logging.core.JavaLogger [main] Successfully released change log lock
2022-10-11 11:07:58,516 INFO org.hibernate.jpa.internal.util.LogHelper [main] HHH000204: Processing PersistenceUnitInfo [name: default]
2022-10-11 11:07:58,549 INFO org.hibernate.Version [main] HHH000412: Hibernate ORM core version 5.6.10.Final
2022-10-11 11:07:58,654 INFO org.hibernate.annotations.common.reflection.java.JavaReflectionManager [main] HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2022-10-11 11:07:58,746 INFO org.hibernate.dialect.Dialect [main] HHH000400: Using dialect: org.hibernate.dialect.PostgreSQL10Dialect
2022-10-11 11:07:59,244 INFO org.hibernate.engine.transaction.jta.platform.internal.JtaPlatformInitiator [main] HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2022-10-11 11:07:59,248 INFO org.springframework.orm.jpa.AbstractEntityManagerFactoryBean [main] Initialized JPA EntityManagerFactory for persistence unit 'default'
2022-10-11 11:07:59,757 WARN org.springframework.context.support.AbstractApplicationContext [main] Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'botInitializer' defined in file [C:\Users\a.miachyn\IdeaProjects\SpringGodelBot\target\classes\com\godeltech\springgodelbot\config\BotInitializer.class]: Unsatisfied dependency expressed through constructor parameter 2; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'tudaSudaTelegramBot' defined in class path resource [com/godeltech/springgodelbot/config/AppConfig.class]: Unsatisfied dependency expressed through method 'tudaSudaTelegramBot' parameter 1; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'messageResolverServiceImpl' defined in file [C:\Users\a.miachyn\IdeaProjects\SpringGodelBot\target\classes\com\godeltech\springgodelbot\service\impl\MessageResolverServiceImpl.class]: Unsatisfied dependency expressed through constructor parameter 0; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'messageResolver' defined in file [C:\Users\a.miachyn\IdeaProjects\SpringGodelBot\target\classes\com\godeltech\springgodelbot\resolver\message\MessageResolver.class]: Unsatisfied dependency expressed through constructor parameter 0; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'onlyTextMessageType' defined in file [C:\Users\a.miachyn\IdeaProjects\SpringGodelBot\target\classes\com\godeltech\springgodelbot\resolver\message\type\impl\OnlyTextMessageType.class]: Unsatisfied dependency expressed through constructor parameter 2; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'tokenServiceImpl' defined in file [C:\Users\a.miachyn\IdeaProjects\SpringGodelBot\target\classes\com\godeltech\springgodelbot\service\impl\TokenServiceImpl.class]: Unsatisfied dependency expressed through constructor parameter 1; nested exception is org.springframework.beans.factory.BeanCurrentlyInCreationException: Error creating bean with name 'tudaSudaTelegramBot': Requested bean is currently in creation: Is there an unresolvable circular reference?
2022-10-11 11:07:59,757 INFO org.springframework.orm.jpa.AbstractEntityManagerFactoryBean [main] Closing JPA EntityManagerFactory for persistence unit 'default'
2022-10-11 11:07:59,757 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Shutdown initiated...
2022-10-11 11:07:59,769 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Shutdown completed.
2022-10-11 11:07:59,772 INFO org.apache.juli.logging.DirectJDKLog [main] Stopping service [Tomcat]
2022-10-11 11:07:59,782 INFO org.springframework.boot.autoconfigure.logging.ConditionEvaluationReportLoggingListener [main] 

Error starting ApplicationContext. To display the conditions report re-run your application with 'debug' enabled.
2022-10-11 11:07:59,799 ERROR org.springframework.boot.diagnostics.LoggingFailureAnalysisReporter [main] 

***************************
APPLICATION FAILED TO START
***************************

Description:

The dependencies of some of the beans in the application context form a cycle:

   botInitializer defined in file [C:\Users\a.miachyn\IdeaProjects\SpringGodelBot\target\classes\com\godeltech\springgodelbot\config\BotInitializer.class]
┌─────┐
|  tudaSudaTelegramBot defined in class path resource [com/godeltech/springgodelbot/config/AppConfig.class]
↑     ↓
|  messageResolverServiceImpl defined in file [C:\Users\a.miachyn\IdeaProjects\SpringGodelBot\target\classes\com\godeltech\springgodelbot\service\impl\MessageResolverServiceImpl.class]
↑     ↓
|  messageResolver defined in file [C:\Users\a.miachyn\IdeaProjects\SpringGodelBot\target\classes\com\godeltech\springgodelbot\resolver\message\MessageResolver.class]
↑     ↓
|  onlyTextMessageType defined in file [C:\Users\a.miachyn\IdeaProjects\SpringGodelBot\target\classes\com\godeltech\springgodelbot\resolver\message\type\impl\OnlyTextMessageType.class]
↑     ↓
|  tokenServiceImpl defined in file [C:\Users\a.miachyn\IdeaProjects\SpringGodelBot\target\classes\com\godeltech\springgodelbot\service\impl\TokenServiceImpl.class]
└─────┘


Action:

Relying upon circular references is discouraged and they are prohibited by default. Update your application to remove the dependency cycle between beans. As a last resort, it may be possible to break the cycle automatically by setting spring.main.allow-circular-references to true.

2022-10-11 11:18:30,170 INFO org.springframework.boot.StartupInfoLogger [main] Starting SpringGodelBotApplication using Java 11.0.12 on INV-2021-L with PID 1748 (C:\Users\a.miachyn\IdeaProjects\SpringGodelBot\target\classes started by a.miachyn in C:\Users\a.miachyn\IdeaProjects\SpringGodelBot)
2022-10-11 11:18:30,170 INFO org.springframework.boot.SpringApplication [main] No active profile set, falling back to 1 default profile: "default"
2022-10-11 11:18:30,648 INFO org.springframework.data.repository.config.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2022-10-11 11:18:30,706 INFO org.springframework.data.repository.config.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 49 ms. Found 4 JPA repository interfaces.
2022-10-11 11:18:31,023 INFO org.springframework.boot.web.embedded.tomcat.TomcatWebServer [main] Tomcat initialized with port(s): 5000 (http)
2022-10-11 11:18:31,039 INFO org.apache.juli.logging.DirectJDKLog [main] Initializing ProtocolHandler ["http-nio-5000"]
2022-10-11 11:18:31,039 INFO org.apache.juli.logging.DirectJDKLog [main] Starting service [Tomcat]
2022-10-11 11:18:31,039 INFO org.apache.juli.logging.DirectJDKLog [main] Starting Servlet engine: [Apache Tomcat/9.0.65]
2022-10-11 11:18:31,107 INFO org.apache.juli.logging.DirectJDKLog [main] Initializing Spring embedded WebApplicationContext
2022-10-11 11:18:31,107 INFO org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext [main] Root WebApplicationContext: initialization completed in 886 ms
2022-10-11 11:18:31,215 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Starting...
2022-10-11 11:18:31,280 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Start completed.
2022-10-11 11:18:31,360 INFO liquibase.logging.core.JavaLogger [main] Set default schema name to public
2022-10-11 11:18:31,440 INFO liquibase.logging.core.JavaLogger [main] Successfully acquired change log lock
2022-10-11 11:18:31,708 INFO liquibase.logging.core.JavaLogger [main] Reading from public.databasechangelog
2022-10-11 11:18:31,781 INFO liquibase.logging.core.JavaLogger [main] Successfully released change log lock
2022-10-11 11:18:31,849 INFO org.hibernate.jpa.internal.util.LogHelper [main] HHH000204: Processing PersistenceUnitInfo [name: default]
2022-10-11 11:18:31,886 INFO org.hibernate.Version [main] HHH000412: Hibernate ORM core version 5.6.10.Final
2022-10-11 11:18:31,965 INFO org.hibernate.annotations.common.reflection.java.JavaReflectionManager [main] HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2022-10-11 11:18:32,024 INFO org.hibernate.dialect.Dialect [main] HHH000400: Using dialect: org.hibernate.dialect.PostgreSQL10Dialect
2022-10-11 11:18:32,366 INFO org.hibernate.engine.transaction.jta.platform.internal.JtaPlatformInitiator [main] HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2022-10-11 11:18:32,366 INFO org.springframework.orm.jpa.AbstractEntityManagerFactoryBean [main] Initialized JPA EntityManagerFactory for persistence unit 'default'
2022-10-11 11:18:32,841 WARN org.springframework.boot.autoconfigure.orm.jpa.JpaBaseConfiguration$JpaWebConfiguration [main] spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2022-10-11 11:18:33,041 INFO org.apache.juli.logging.DirectJDKLog [main] Starting ProtocolHandler ["http-nio-5000"]
2022-10-11 11:18:33,057 INFO org.springframework.boot.web.embedded.tomcat.TomcatWebServer [main] Tomcat started on port(s): 5000 (http) with context path ''
2022-10-11 11:18:33,072 INFO com.godeltech.springgodelbot.config.BotInitializer [main] Set web hook with path :https://1561-82-209-241-194.eu.ngrok.io
2022-10-11 11:18:33,072 INFO com.godeltech.springgodelbot.service.impl.RestServiceImpl [main] Set webhook with path :https://1561-82-209-241-194.eu.ngrok.io
2022-10-11 11:18:33,072 INFO com.godeltech.springgodelbot.scheduler.impl.ScheduleServiceImpl [scheduling-1] Deleting expired offers
2022-10-11 11:18:33,093 INFO com.godeltech.springgodelbot.service.impl.TokenServiceImpl [scheduling-1] Delete non usable expired tokens
2022-10-11 11:18:33,141 ERROR org.springframework.scheduling.support.TaskUtils$LoggingErrorHandler [scheduling-1] Unexpected error occurred in scheduled task
org.springframework.dao.InvalidDataAccessApiUsageException: Parameter value [2022-10-10] did not match expected type [java.util.Date (n/a)]; nested exception is java.lang.IllegalArgumentException: Parameter value [2022-10-10] did not match expected type [java.util.Date (n/a)]
	at org.springframework.orm.jpa.EntityManagerFactoryUtils.convertJpaAccessExceptionIfPossible(EntityManagerFactoryUtils.java:374)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:235)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:551)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy128.findByCreatedAtBeforeAndMessageIdIsNull(Unknown Source)
	at com.godeltech.springgodelbot.service.impl.TokenServiceImpl.deleteNonUsableExpiredTokens(TokenServiceImpl.java:115)
	at com.godeltech.springgodelbot.service.impl.TokenServiceImpl$$FastClassBySpringCGLIB$$8745aeb6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at com.godeltech.springgodelbot.service.impl.TokenServiceImpl$$EnhancerBySpringCGLIB$$61c95b30.deleteNonUsableExpiredTokens(<generated>)
	at com.godeltech.springgodelbot.service.impl.TudaSudaTelegramBot.deleteExpiredTokens(TudaSudaTelegramBot.java:138)
	at com.godeltech.springgodelbot.scheduler.impl.ScheduleServiceImpl.deleteExpireTokens(ScheduleServiceImpl.java:36)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java:305)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:834)
Caused by: java.lang.IllegalArgumentException: Parameter value [2022-10-10] did not match expected type [java.util.Date (n/a)]
	at org.hibernate.query.spi.QueryParameterBindingValidator.validate(QueryParameterBindingValidator.java:54)
	at org.hibernate.query.spi.QueryParameterBindingValidator.validate(QueryParameterBindingValidator.java:27)
	at org.hibernate.query.internal.QueryParameterBindingImpl.validate(QueryParameterBindingImpl.java:90)
	at org.hibernate.query.internal.QueryParameterBindingImpl.setBindValue(QueryParameterBindingImpl.java:55)
	at org.hibernate.query.internal.AbstractProducedQuery.setParameter(AbstractProducedQuery.java:501)
	at org.hibernate.query.internal.AbstractProducedQuery.setParameter(AbstractProducedQuery.java:122)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.setParameter(CriteriaQueryTypeQueryAdapter.java:393)
	at org.hibernate.query.criteria.internal.compile.CriteriaQueryTypeQueryAdapter.setParameter(CriteriaQueryTypeQueryAdapter.java:61)
	at org.springframework.data.jpa.repository.query.QueryParameterSetter$BindableQuery.setParameter(QueryParameterSetter.java:318)
	at org.springframework.data.jpa.repository.query.QueryParameterSetter$NamedOrIndexedQueryParameterSetter.lambda$setParameter$3(QueryParameterSetter.java:115)
	at org.springframework.data.jpa.repository.query.QueryParameterSetter$ErrorHandling$1.execute(QueryParameterSetter.java:140)
	at org.springframework.data.jpa.repository.query.QueryParameterSetter$NamedOrIndexedQueryParameterSetter.setParameter(QueryParameterSetter.java:115)
	at org.springframework.data.jpa.repository.query.ParameterBinder.bind(ParameterBinder.java:82)
	at org.springframework.data.jpa.repository.query.ParameterBinder.bind(ParameterBinder.java:74)
	at org.springframework.data.jpa.repository.query.ParameterBinder.bindAndPrepare(ParameterBinder.java:96)
	at org.springframework.data.jpa.repository.query.PartTreeJpaQuery$QueryPreparer.invokeBinding(PartTreeJpaQuery.java:324)
	at org.springframework.data.jpa.repository.query.PartTreeJpaQuery$QueryPreparer.createQuery(PartTreeJpaQuery.java:243)
	at org.springframework.data.jpa.repository.query.PartTreeJpaQuery.doCreateQuery(PartTreeJpaQuery.java:106)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.createQuery(AbstractJpaQuery.java:233)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$CollectionExecution.doExecute(JpaQueryExecution.java:128)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:156)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:144)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:137)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:121)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:160)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:139)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:81)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 34 common frames omitted
2022-10-11 11:18:33,141 INFO com.godeltech.springgodelbot.scheduler.impl.ScheduleServiceImpl [scheduling-1] Deleting expired offers
2022-10-11 11:18:33,157 INFO com.godeltech.springgodelbot.service.impl.OfferServiceImpl [scheduling-1] Delete offers whose second date is earlier than : 2022-10-11
2022-10-11 11:18:33,177 INFO com.godeltech.springgodelbot.service.impl.OfferServiceImpl [scheduling-1] Delete offers whose first date is earlier than :2022-10-11 and second date is null
2022-10-11 11:18:33,821 INFO org.springframework.boot.StartupInfoLogger [main] Started SpringGodelBotApplication in 3.977 seconds (JVM running for 4.67)
2022-10-11 11:22:34,477 INFO org.springframework.orm.jpa.AbstractEntityManagerFactoryBean [SpringApplicationShutdownHook] Closing JPA EntityManagerFactory for persistence unit 'default'
2022-10-11 11:22:34,479 INFO com.zaxxer.hikari.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown initiated...
2022-10-11 11:22:34,485 INFO com.zaxxer.hikari.HikariDataSource [SpringApplicationShutdownHook] HikariPool-1 - Shutdown completed.
2022-10-11 11:22:39,640 INFO org.springframework.boot.StartupInfoLogger [main] Starting SpringGodelBotApplication using Java 11.0.12 on INV-2021-L with PID 8020 (C:\Users\a.miachyn\IdeaProjects\SpringGodelBot\target\classes started by a.miachyn in C:\Users\a.miachyn\IdeaProjects\SpringGodelBot)
2022-10-11 11:22:39,644 INFO org.springframework.boot.SpringApplication [main] No active profile set, falling back to 1 default profile: "default"
2022-10-11 11:22:40,160 INFO org.springframework.data.repository.config.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2022-10-11 11:22:40,212 INFO org.springframework.data.repository.config.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 49 ms. Found 4 JPA repository interfaces.
2022-10-11 11:22:40,546 INFO org.springframework.boot.web.embedded.tomcat.TomcatWebServer [main] Tomcat initialized with port(s): 5000 (http)
2022-10-11 11:22:40,546 INFO org.apache.juli.logging.DirectJDKLog [main] Initializing ProtocolHandler ["http-nio-5000"]
2022-10-11 11:22:40,546 INFO org.apache.juli.logging.DirectJDKLog [main] Starting service [Tomcat]
2022-10-11 11:22:40,546 INFO org.apache.juli.logging.DirectJDKLog [main] Starting Servlet engine: [Apache Tomcat/9.0.65]
2022-10-11 11:22:40,630 INFO org.apache.juli.logging.DirectJDKLog [main] Initializing Spring embedded WebApplicationContext
2022-10-11 11:22:40,630 INFO org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext [main] Root WebApplicationContext: initialization completed in 964 ms
2022-10-11 11:22:40,735 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Starting...
2022-10-11 11:22:40,800 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Start completed.
2022-10-11 11:22:40,880 INFO liquibase.logging.core.JavaLogger [main] Set default schema name to public
2022-10-11 11:22:40,956 INFO liquibase.logging.core.JavaLogger [main] Successfully acquired change log lock
2022-10-11 11:22:41,220 INFO liquibase.logging.core.JavaLogger [main] Reading from public.databasechangelog
2022-10-11 11:22:41,293 INFO liquibase.logging.core.JavaLogger [main] Successfully released change log lock
2022-10-11 11:22:41,351 INFO org.hibernate.jpa.internal.util.LogHelper [main] HHH000204: Processing PersistenceUnitInfo [name: default]
2022-10-11 11:22:41,384 INFO org.hibernate.Version [main] HHH000412: Hibernate ORM core version 5.6.10.Final
2022-10-11 11:22:41,446 INFO org.hibernate.annotations.common.reflection.java.JavaReflectionManager [main] HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2022-10-11 11:22:41,511 INFO org.hibernate.dialect.Dialect [main] HHH000400: Using dialect: org.hibernate.dialect.PostgreSQL10Dialect
2022-10-11 11:22:41,847 INFO org.hibernate.engine.transaction.jta.platform.internal.JtaPlatformInitiator [main] HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2022-10-11 11:22:41,847 INFO org.springframework.orm.jpa.AbstractEntityManagerFactoryBean [main] Initialized JPA EntityManagerFactory for persistence unit 'default'
2022-10-11 11:22:42,315 WARN org.springframework.boot.autoconfigure.orm.jpa.JpaBaseConfiguration$JpaWebConfiguration [main] spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2022-10-11 11:22:42,510 INFO org.apache.juli.logging.DirectJDKLog [main] Starting ProtocolHandler ["http-nio-5000"]
2022-10-11 11:22:42,529 INFO org.springframework.boot.web.embedded.tomcat.TomcatWebServer [main] Tomcat started on port(s): 5000 (http) with context path ''
2022-10-11 11:22:42,537 INFO com.godeltech.springgodelbot.config.BotInitializer [main] Set web hook with path :https://1561-82-209-241-194.eu.ngrok.io
2022-10-11 11:22:42,537 INFO com.godeltech.springgodelbot.service.impl.RestServiceImpl [main] Set webhook with path :https://1561-82-209-241-194.eu.ngrok.io
2022-10-11 11:22:42,537 INFO com.godeltech.springgodelbot.scheduler.impl.ScheduleServiceImpl [scheduling-1] Deleting expired offers
2022-10-11 11:22:42,557 INFO com.godeltech.springgodelbot.service.impl.OfferServiceImpl [scheduling-1] Delete offers whose second date is earlier than : 2022-10-11
2022-10-11 11:22:42,632 INFO com.godeltech.springgodelbot.service.impl.OfferServiceImpl [scheduling-1] Delete offers whose first date is earlier than :2022-10-11 and second date is null
2022-10-11 11:22:42,638 INFO com.godeltech.springgodelbot.scheduler.impl.ScheduleServiceImpl [scheduling-1] Deleting expired offers
2022-10-11 11:22:42,642 INFO com.godeltech.springgodelbot.service.impl.TokenServiceImpl [scheduling-1] Delete non usable expired tokens
2022-10-11 11:22:42,651 INFO com.godeltech.springgodelbot.service.impl.TokenServiceImpl [scheduling-1] Remove expired token
2022-10-11 11:22:42,655 INFO com.godeltech.springgodelbot.service.impl.TokenServiceImpl [scheduling-1] Delete tokens : []
2022-10-11 11:22:43,129 INFO org.springframework.boot.StartupInfoLogger [main] Started SpringGodelBotApplication in 3.82 seconds (JVM running for 4.679)
